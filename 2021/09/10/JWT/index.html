<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>JWT | Cheyennee</title><meta name="keywords" content="blog"><meta name="author" content="Cheyennee,714851125@qq.com"><meta name="copyright" content="Cheyennee"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="记录JWT知识点">
<meta property="og:type" content="article">
<meta property="og:title" content="JWT">
<meta property="og:url" content="http://cheyennee.github.io/2021/09/10/JWT/index.html">
<meta property="og:site_name" content="Cheyennee">
<meta property="og:description" content="记录JWT知识点">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cheyennee-blog.oss-cn-hangzhou.aliyuncs.com/images/jwt/cover.png">
<meta property="article:published_time" content="2021-09-10T12:27:20.000Z">
<meta property="article:modified_time" content="2022-11-29T09:18:26.273Z">
<meta property="article:author" content="Cheyennee">
<meta property="article:tag" content="blog">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cheyennee-blog.oss-cn-hangzhou.aliyuncs.com/images/jwt/cover.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://cheyennee.github.io/2021/09/10/JWT/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'JWT',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-11-29 17:18:26'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">50</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">2</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">19</div></a></div><hr/></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Cheyennee</a></span><div id="menus"><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">JWT</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-09-10T12:27:20.000Z" title="发表于 2021-09-10 20:27:20">2021-09-10</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-11-29T09:18:26.273Z" title="更新于 2022-11-29 17:18:26">2022-11-29</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/JWT/">JWT</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="JWT"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="post-content" id="article-container"><h2 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h2><blockquote>
<p>​	我们登录淘宝的时候首先要登录，我们看到了一个商品点进去，进行了页面跳转&#x2F;刷新，按照HTTP的无状态协议岂不是又要登录一次？<br>​	所以为了解决这个问题，Cookie诞生了，在保留无状态协议这个特征的同时又要解决类似记录状态的矛盾问题。Cookie 技术通过在请求和响应报文中写入Cookie 信息来控制客户端的状态。<br>​	Cookie 会根据从服务器端发送的响应报文内的一个叫做Set-Cookie的首部字段信息，通知客户端保存Cookie。当下次客户端再往该服务器发送请求时，客户端会<strong>自动</strong>在请求报文中加入Cookie 值后发送出去。<br>​	服务器端发现客户端发送过来的Cookie 后，会去检查究竟是从哪一个客户端发来的连接请求，然后对比服务器上的记录，最后得到之前的状态信息。</p>
</blockquote>
<ul>
<li>没有Cookie信息状态下的请求</li>
</ul>
<img src="https://cheyennee-blog.oss-cn-hangzhou.aliyuncs.com/images/jwt/pic1.png" alt="没有cookie" style="zoom:80%;">

<ul>
<li>第2次以后（存有Cookie信息状态）的请求</li>
</ul>
<img src="https://cheyennee-blog.oss-cn-hangzhou.aliyuncs.com/images/jwt/pic2.png" alt="有cookie" style="zoom:80%;">

<p>HTTP 请求报文和响应报文的内容如下（数字和图中对应）。<br>① 请求报文（没有Cookie 信息的状态）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GET /reader/ HTTP/1.1</span><br><span class="line">Host: hackr.jp</span><br><span class="line">*首部字段内没有Cookie的相关信息</span><br></pre></td></tr></table></figure>

<p>② 响应报文（服务器端生成Cookie 信息）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Date: Thu, 12 Jul 2012 07:12:20 GMT</span><br><span class="line">Server: Apache</span><br><span class="line">＜Set-Cookie: sid=1342077140226724; path=/; expires=Wed,10-Oct-12 07:12:20 GMT＞</span><br><span class="line">Content-Type: text/plain; charset=UTF-8</span><br></pre></td></tr></table></figure>

<p>③ 请求报文（自动发送保存着的Cookie 信息）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GET /image/ HTTP/1.1</span><br><span class="line">Host: hackr.jp</span><br><span class="line">Cookie: sid=1342077140226724</span><br></pre></td></tr></table></figure>

<h3 id="cookie字段"><a href="#cookie字段" class="headerlink" title="cookie字段"></a>cookie字段</h3><h5 id="expires-属性"><a href="#expires-属性" class="headerlink" title="expires 属性"></a>expires 属性</h5><blockquote>
<p>​	Cookie 的expires 属性指定浏览器可发送Cookie 的有效期。当省略expires 属性时，Cookie仅在浏览器关闭之前有效。<br>​	另外，一旦Cookie 从服务器端发送至客户端，服务器端就不存在可以显式删除Cookie 的方法。但可通过覆盖已过期的Cookie，实现对客户端Cookie 的实质性删除操作。</p>
</blockquote>
<h5 id="path-属性"><a href="#path-属性" class="headerlink" title="path 属性"></a>path 属性</h5><blockquote>
<p>​	Cookie 的path 属性可用于限制指定Cookie 的发送范围的文件目录。不过另有办法可避开这项限制，看来对其作为安全机制的效果不能抱有期待。</p>
</blockquote>
<h5 id="domain-属性"><a href="#domain-属性" class="headerlink" title="domain 属性"></a>domain 属性</h5><blockquote>
<p>​	通过Cookie 的domain 属性指定的域名可做到与结尾匹配一致。比如， 当指定<a target="_blank" rel="noopener" href="http://example.com/">http://example.com</a> 后， 除<a target="_blank" rel="noopener" href="http://example.com/">http://example.com</a> 以外，Example Domain或www2.example.com 等都可以发送Cookie。因此，除了针对具体指定的多个域名发送Cookie 之外，不指定domain 属性显得更安全。</p>
</blockquote>
<h5 id="secure-属性"><a href="#secure-属性" class="headerlink" title="secure 属性"></a>secure 属性</h5><blockquote>
<p>​	Cookie 的secure 属性用于限制Web 页面仅在HTTPS 安全连接时，才可以发送Cookie。发送Cookie 时，指定secure 属性的方法如下所示。<br>​	Set-Cookie: name&#x3D;value; secure<br>​	以上例子仅当在https ：&#x2F;&#x2F;Example Domain（HTTPS）安全连接的情况下才会进行Cookie 的回收。也就是说，即使域名相同时http : &#x2F;&#x2F;Example Domain（HTTP） 也不会发生Cookie 回收行为。当省略secure 属性时，不论HTTP 还是HTTPS，都会对Cookie 进行回收。</p>
</blockquote>
<h5 id="HttpOnly-属性"><a href="#HttpOnly-属性" class="headerlink" title="HttpOnly 属性"></a>HttpOnly 属性</h5><blockquote>
<p>​	Cookie 的HttpOnly 属性是Cookie 的扩展功能，它使JavaScript 脚本无法获得Cookie。其主要目的为防止跨站脚本攻击（Cross-sitescripting，XSS）对Cookie 的信息窃取。<br>​	发送指定HttpOnly 属性的Cookie 的方法如下所示。<br>​		Set-Cookie: name&#x3D;value; HttpOnly<br>​	通过上述设置，通常从Web 页面内还可以对Cookie 进行读取操作。但使用JavaScript 的document.cookie 就无法读取附加HttpOnly 属性后的Cookie 的内容了。因此，也就无法在XSS 中利用JavaScript 劫持Cookie 了。<br>​	虽然是独立的扩展功能，但Internet Explorer 6 SP1 以上版本等当下的主流浏览器都已经支持该扩展了。另外顺带一提，该扩展并非是为了防止XSS 而开发的。</p>
</blockquote>
<h3 id="Cookie有哪些缺陷-？"><a href="#Cookie有哪些缺陷-？" class="headerlink" title="Cookie有哪些缺陷 ？"></a>Cookie有哪些缺陷 ？</h3><blockquote>
<ul>
<li>数量受到限制。一个浏览器能创建的 Cookie 数量最多为 300 个，并且每个不能超过 4KB，每个 Web 站点能设置的<br>Cookie 总数不能超过 20 个</li>
<li>安全性无法得到保障。通常跨站点脚本攻击往往利用网站漏洞在网站页面中植入脚本代码或网站页面引用第三方法脚本代码，均存在跨站点脚本攻击的可能，在受到跨站点脚本攻击时，脚本指令将会读取当前站点的所有Cookie 内容（已不存在 Cookie 作用域限制），然后通过某种方式将 Cookie 内容提交到指定的服务器（如：AJAX）。一旦 Cookie 落入攻击者手中，它将会重现其价值。</li>
<li>浏览器可以禁用Cookie，禁用Cookie后，也就无法享有Cookie带来的方便。</li>
</ul>
</blockquote>
<h3 id="cookie的应用场景"><a href="#cookie的应用场景" class="headerlink" title="cookie的应用场景"></a>cookie的应用场景</h3><img src="https://cheyennee-blog.oss-cn-hangzhou.aliyuncs.com/images/jwt/pic3.png" alt="cookie应用场景" style="zoom:80%;">

<h3 id="什么样的数据适合放入cookie中"><a href="#什么样的数据适合放入cookie中" class="headerlink" title="什么样的数据适合放入cookie中"></a>什么样的数据适合放入cookie中</h3><p>​		浏览器通过Http请求某个域时，会将该域下面的cookie自动放入request header中，所以存放在cookie的数据最合适的是身份认证信息。</p>
<h3 id="cookie格式"><a href="#cookie格式" class="headerlink" title="cookie格式"></a>cookie格式</h3><p>​		通过document.cookie可以拿到当前域下可访问的全部cookie(也就是非httpOnly的cookie)，cookie是由key&#x3D;value的形式组成的，并且每个key,value之间使用分号和空格隔开。</p>
<p><img src="https://cheyennee-blog.oss-cn-hangzhou.aliyuncs.com/images/jwt/pic6.png" alt="cookie格式"></p>
<h3 id="设置、修改、删除cookie"><a href="#设置、修改、删除cookie" class="headerlink" title="设置、修改、删除cookie"></a>设置、修改、删除cookie</h3><h4 id="设置cookie"><a href="#设置cookie" class="headerlink" title="设置cookie"></a>设置cookie</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 设置一个cookie</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">cookie</span> = <span class="string">&quot;name=dl; age=20; sex=max; &quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置多个cookie</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">cookie</span> = <span class="string">&quot;name=dl; &quot;</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">cookie</span> = <span class="string">&quot;age=20; &quot;</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">cookie</span> = <span class="string">&quot;sex=max; &quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="修改和删除cookie"><a href="#修改和删除cookie" class="headerlink" title="修改和删除cookie"></a>修改和删除cookie</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、修改：直接进行赋新值，不过必须保证domain/url属性不变，如果改变则直接新增一个。</span><br><span class="line"><span class="number">2</span>、删除：直接赋新值，不过必须保证domain/url属性不变，并且将expires的时间设置为过去的时间。</span><br></pre></td></tr></table></figure>

<h4 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、在cookie中只有key/domain/path都相同时，才能进行覆盖。</span><br><span class="line"><span class="number">2</span>、在设置domain的value设置多个点，则任何子域名都可以访问。如不不设置点，则只有该domain才能访问。</span><br></pre></td></tr></table></figure>

<h2 id="Session"><a href="#Session" class="headerlink" title="Session"></a>Session</h2><blockquote>
<p>​	Session是另一种记录客户状态的机制，不同的是Cookie保存在客户端浏览器中，而Session保存在<strong>服务器</strong>上。客户端浏览器访问服务器的时候，服务器把客户端信息以某种形式记录在服务器上。这就是Session。客户端浏览器再次访问时只需要从该Session中查找该客户的状态就可以了。</p>
</blockquote>
<blockquote>
<p>​	鉴于HTTP 是无状态协议，之前已认证成功的用户状态无法通过协议层面保存下来。即，无法实现状态管理，因此即使当该用户下一次继续访问，也无法区分他与其他的用户。于是我们会<strong>使用Cookie 来管理Session</strong>，以弥补HTTP 协议中不存在的状态管理功能。</p>
</blockquote>
<img src="https://cheyennee-blog.oss-cn-hangzhou.aliyuncs.com/images/jwt/pic4.png" alt="session" style="zoom:80%;">

<blockquote>
<ol>
<li><p>浏览器端第一次发送请求到服务器端，服务器端创建一个Session，同时会创建一个特殊的<strong>Cookie（name为JSESSIONID的固定值，value为session对象的ID）</strong>，然后将该Cookie发送至浏览器端</p>
</li>
<li><p>浏览器端发送第N（N&gt;1）次请求到服务器端,浏览器端访问服务器端时就会携带该name为JSESSIONID的Cookie对象</p>
</li>
<li><p>服务器端根据name为JSESSIONID的Cookie的value(sessionId),去查询Session对象，从而区分不同用户。</p>
</li>
</ol>
</blockquote>
<h2 id="Session和Cookie的区别？"><a href="#Session和Cookie的区别？" class="headerlink" title="Session和Cookie的区别？"></a>Session和Cookie的区别？</h2><blockquote>
<ol>
<li>数据存储位置：cookie数据存放在客户的浏览器上，session数据放在服务器上。</li>
<li>安全性：cookie不是很安全，别人可以分析存放在本地的cookie并进行cookie欺骗，考虑到安全应当使用session。</li>
<li>服务器性能：session会在一定时间内保存在服务器上。当访问增多，会比较占用你服务器的性能，考虑到减轻服务器性能方面，应当使用cookie。</li>
<li>数据大小：单个cookie保存的数据不能超过4K，很多浏览器都限制一个站点最多保存20个cookie。</li>
<li>信息重要程度：可以考虑将登陆信息等重要信息存放为session，其他信息如果需要保留，可以放在cookie中。</li>
</ol>
</blockquote>
<h2 id="JWT"><a href="#JWT" class="headerlink" title="JWT"></a>JWT</h2><h3 id="什么是JWT"><a href="#什么是JWT" class="headerlink" title="什么是JWT"></a>什么是JWT</h3><h4 id="token进行用户身份验证的流程"><a href="#token进行用户身份验证的流程" class="headerlink" title="token进行用户身份验证的流程"></a>token进行用户身份验证的流程</h4><blockquote>
<ol>
<li>客户端使用用户名和密码请求登录</li>
<li>服务端收到请求，验证用户名和密码</li>
<li>验证成功后，服务端会签发一个<code>token</code>，再把这个<code>token</code>返回给客户端</li>
<li>客户端收到token后可以把它存储起来，比如放到cookie中</li>
<li>客户端每次向服务端请求资源时需要携带服务端签发的token，可以在<code>cookie</code>或者<code>header</code>中携带</li>
<li>服务端收到请求，然后去验证客户端请求里面带着的<code>token</code>，如果验证成功，就向客户端返回请求数据</li>
</ol>
</blockquote>
<h4 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h4><blockquote>
<ul>
<li>这种基于<code>token</code>的认证方式相比传统的<code>session</code>认证方式更节约服务器资源，并且对移动端和分布式更加友好。</li>
<li><strong>支持跨域访问</strong>：<code>cookie</code>是无法跨域的，而<code>token</code>由于没有用到<code>cookie</code>(前提是将<code>token</code>放到请求头中)，所以跨域后不会存在信息丢失问题</li>
<li><strong>无状态</strong>：<code>token</code>机制在服务端不需要存储<code>session</code>信息，因为token自身包含了所有登录用户的信息，所以可以减轻服务端压力</li>
<li><strong>更适用CDN</strong>：可以通过内容分发网络请求服务端的所有资料</li>
<li><strong>更适用于移动端</strong>：当客户端是非浏览器平台时，<code>cookie</code>是不被支持的，此时采用<code>token</code>认证方式会简单很多</li>
<li><strong>无需考虑CSRF</strong>：由于不再依赖<code>cookie</code>，所以采用token认证方式不会发生CSRF，所以也就无需考虑CSRF的防御</li>
</ul>
</blockquote>
<p>​	而<code>JWT</code>就是上述流程当中<code>token</code>的一种具体实现方式，其全称是<code>JSON Web Token</code>，官网地址：<a target="_blank" rel="noopener" href="https://jwt.io/">https://jwt.io/</a></p>
<p>​	通俗地说，<strong>JWT的本质就是一个字符串</strong>，它是将用户信息保存到一个Json字符串中，然后进行编码后得到一个<code>JWT token</code>，<strong>并且这个<code>JWT token</code>带有签名信息，接收后可以校验是否被篡改</strong>，所以可以用于在各方之间安全地将信息作为Json对象传输。</p>
<h4 id="JWT的认证流程"><a href="#JWT的认证流程" class="headerlink" title="JWT的认证流程"></a>JWT的认证流程</h4><blockquote>
<ol>
<li>首先，前端通过Web表单将自己的用户名和密码发送到后端的接口，这个过程一般是一个<code>POST</code>请求。建议的方式是通过SSL加密的传输(HTTPS)，从而避免敏感信息被嗅探</li>
<li>后端核对用户名和密码成功后，<strong>将包含用户信息的数据作为JWT的Payload，将其与JWT Header分别进行Base64编码拼接后签名</strong>，形成一个<code>JWT Token</code>，形成的<code>JWT Token</code>就是一个如同<code>lll.zzz.xxx</code>的字符串</li>
<li>后端将<code>JWT Token</code>字符串作为登录成功的结果返回给前端。前端可以将返回的结果保存在浏览器中，退出登录时删除保存的<code>JWT Token</code>即可</li>
<li><strong>前端在每次请求时将<code>JWT Token</code>放入HTTP请求头中的<code>Authorization</code>属性中</strong>(解决XSS和XSRF问题)</li>
<li>后端检查前端传过来的<code>JWT Token</code>，验证其有效性，比如检查签名是否正确、是否过期、token的接收方是否是自己等等</li>
<li>验证通过后，后端解析出<code>JWT Token</code>中包含的用户信息，进行其他逻辑操作(一般是根据用户信息得到权限等)，返回结果</li>
</ol>
</blockquote>
<img src="https://cheyennee-blog.oss-cn-hangzhou.aliyuncs.com/images/jwt/pic5.png" alt="JWT token" style="zoom:80%;">

<h3 id="JWT认证的优势"><a href="#JWT认证的优势" class="headerlink" title="JWT认证的优势"></a>JWT认证的优势</h3><blockquote>
<ul>
<li>简洁：<code>JWT Token</code>数据量小，传输速度也很快</li>
<li>因为JWT Token是以JSON加密形式保存在客户端的，所以JWT是<strong>跨语言</strong>的，原则上任何web形式都支持</li>
<li>不需要在服务端保存会话信息，也就是说<strong>不依赖于cookie和session，所以没有了传统session认证的弊端，特别适用于分布式微服务</strong></li>
<li><strong>单点登录友好</strong>：使用Session进行身份认证的话，由于cookie无法跨域，难以实现单点登录。但是，使用token进行认证的话， <strong>token可以被保存在客户端的任意位置的内存中，不一定是cookie，所以不依赖cookie</strong>，不会存在这些问题</li>
<li><strong>适合移动端应用</strong>：使用Session进行身份认证的话，需要保存一份信息在服务器端，而且这种方式会依赖到Cookie（需要 Cookie 保存 SessionId），所以不适合移动端</li>
</ul>
</blockquote>
<h3 id="JWT结构"><a href="#JWT结构" class="headerlink" title="JWT结构"></a>JWT结构</h3><p>JWT由3部分组成：标头(Header)、有效载荷(Payload)和签名(Signature)。在传输的时候，会将JWT的3部分分别进行Base64编码后用<code>.</code>进行连接形成最终传输的字符串。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">JWTString = Base64(Header).</span><br><span class="line">            Base64(Payload).</span><br><span class="line">            HMACSHA256(base64UrlEncode(header) + “.” + base64UrlEncode(payload), secret)</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://cheyennee.github.io">Cheyennee</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://cheyennee.github.io/2021/09/10/JWT/">http://cheyennee.github.io/2021/09/10/JWT/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://cheyennee.github.io" target="_blank">Cheyennee</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://cheyennee-blog.oss-cn-hangzhou.aliyuncs.com/images/jwt/cover.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/09/13/%E6%89%8B%E5%86%99%E9%A2%98/"><img class="prev-cover" src="https://cheyennee-blog.oss-cn-hangzhou.aliyuncs.com/images/handwrite/pic4.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">手写题</div></div></a></div><div class="next-post pull-right"><a href="/2021/08/01/%E5%88%87%E6%8D%A2%E4%B8%BB%E9%A2%98/"><img class="next-cover" src="https://cheyennee-blog.oss-cn-hangzhou.aliyuncs.com/images/theme/cover.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">切换主题</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Cheyennee</div><div class="author-info__description">生而为人，还请努力</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">50</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">2</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">19</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/cheyennee"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">在路上</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Cookie"><span class="toc-number">1.</span> <span class="toc-text">Cookie</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#cookie%E5%AD%97%E6%AE%B5"><span class="toc-number">1.1.</span> <span class="toc-text">cookie字段</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#expires-%E5%B1%9E%E6%80%A7"><span class="toc-number">1.1.0.1.</span> <span class="toc-text">expires 属性</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#path-%E5%B1%9E%E6%80%A7"><span class="toc-number">1.1.0.2.</span> <span class="toc-text">path 属性</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#domain-%E5%B1%9E%E6%80%A7"><span class="toc-number">1.1.0.3.</span> <span class="toc-text">domain 属性</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#secure-%E5%B1%9E%E6%80%A7"><span class="toc-number">1.1.0.4.</span> <span class="toc-text">secure 属性</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#HttpOnly-%E5%B1%9E%E6%80%A7"><span class="toc-number">1.1.0.5.</span> <span class="toc-text">HttpOnly 属性</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cookie%E6%9C%89%E5%93%AA%E4%BA%9B%E7%BC%BA%E9%99%B7-%EF%BC%9F"><span class="toc-number">1.2.</span> <span class="toc-text">Cookie有哪些缺陷 ？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cookie%E7%9A%84%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">1.3.</span> <span class="toc-text">cookie的应用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%A0%B7%E7%9A%84%E6%95%B0%E6%8D%AE%E9%80%82%E5%90%88%E6%94%BE%E5%85%A5cookie%E4%B8%AD"><span class="toc-number">1.4.</span> <span class="toc-text">什么样的数据适合放入cookie中</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cookie%E6%A0%BC%E5%BC%8F"><span class="toc-number">1.5.</span> <span class="toc-text">cookie格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E3%80%81%E4%BF%AE%E6%94%B9%E3%80%81%E5%88%A0%E9%99%A4cookie"><span class="toc-number">1.6.</span> <span class="toc-text">设置、修改、删除cookie</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AEcookie"><span class="toc-number">1.6.1.</span> <span class="toc-text">设置cookie</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E5%92%8C%E5%88%A0%E9%99%A4cookie"><span class="toc-number">1.6.2.</span> <span class="toc-text">修改和删除cookie</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F"><span class="toc-number">1.6.3.</span> <span class="toc-text">注意</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Session"><span class="toc-number">2.</span> <span class="toc-text">Session</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Session%E5%92%8CCookie%E7%9A%84%E5%8C%BA%E5%88%AB%EF%BC%9F"><span class="toc-number">3.</span> <span class="toc-text">Session和Cookie的区别？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JWT"><span class="toc-number">4.</span> <span class="toc-text">JWT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFJWT"><span class="toc-number">4.1.</span> <span class="toc-text">什么是JWT</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#token%E8%BF%9B%E8%A1%8C%E7%94%A8%E6%88%B7%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%9A%84%E6%B5%81%E7%A8%8B"><span class="toc-number">4.1.1.</span> <span class="toc-text">token进行用户身份验证的流程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%98%E7%82%B9"><span class="toc-number">4.1.2.</span> <span class="toc-text">优点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JWT%E7%9A%84%E8%AE%A4%E8%AF%81%E6%B5%81%E7%A8%8B"><span class="toc-number">4.1.3.</span> <span class="toc-text">JWT的认证流程</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JWT%E8%AE%A4%E8%AF%81%E7%9A%84%E4%BC%98%E5%8A%BF"><span class="toc-number">4.2.</span> <span class="toc-text">JWT认证的优势</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JWT%E7%BB%93%E6%9E%84"><span class="toc-number">4.3.</span> <span class="toc-text">JWT结构</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/09/10/%E5%9F%8B%E7%82%B9/" title="埋点"><img src="https://cheyennee-blog.oss-cn-hangzhou.aliyuncs.com/images/interview/cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="埋点"/></a><div class="content"><a class="title" href="/2023/09/10/%E5%9F%8B%E7%82%B9/" title="埋点">埋点</a><time datetime="2023-09-10T09:45:12.000Z" title="发表于 2023-09-10 17:45:12">2023-09-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/09/09/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" title="性能优化"><img src="https://cheyennee-blog.oss-cn-hangzhou.aliyuncs.com/images/flatlist/cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="性能优化"/></a><div class="content"><a class="title" href="/2023/09/09/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" title="性能优化">性能优化</a><time datetime="2023-09-09T12:54:23.000Z" title="发表于 2023-09-09 20:54:23">2023-09-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/09/09/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/" title="垃圾回收"><img src="https://cheyennee-blog.oss-cn-hangzhou.aliyuncs.com/images/js/cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="垃圾回收"/></a><div class="content"><a class="title" href="/2023/09/09/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/" title="垃圾回收">垃圾回收</a><time datetime="2023-09-09T06:01:32.000Z" title="发表于 2023-09-09 14:01:32">2023-09-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/09/08/HTTP-TCP/" title="HTTP-TCP"><img src="https://cheyennee-blog.oss-cn-hangzhou.aliyuncs.com/images/http/cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="HTTP-TCP"/></a><div class="content"><a class="title" href="/2023/09/08/HTTP-TCP/" title="HTTP-TCP">HTTP-TCP</a><time datetime="2023-09-08T01:35:27.000Z" title="发表于 2023-09-08 09:35:27">2023-09-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/09/07/indexdb/" title="indexdb"><img src="https://cheyennee-blog.oss-cn-hangzhou.aliyuncs.com/images/html/pic3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="indexdb"/></a><div class="content"><a class="title" href="/2023/09/07/indexdb/" title="indexdb">indexdb</a><time datetime="2023-09-07T11:27:23.000Z" title="发表于 2023-09-07 19:27:23">2023-09-07</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Cheyennee</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>