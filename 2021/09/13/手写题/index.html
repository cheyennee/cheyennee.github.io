<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>手写题 | Cheyennee</title><meta name="keywords" content="blog"><meta name="author" content="Cheyennee,714851125@qq.com"><meta name="copyright" content="Cheyennee"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="记录JS手写题">
<meta property="og:type" content="article">
<meta property="og:title" content="手写题">
<meta property="og:url" content="http://cheyennee.github.io/2021/09/13/%E6%89%8B%E5%86%99%E9%A2%98/index.html">
<meta property="og:site_name" content="Cheyennee">
<meta property="og:description" content="记录JS手写题">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cheyennee-blog.oss-cn-hangzhou.aliyuncs.com/images/handwrite/pic4.jpg">
<meta property="article:published_time" content="2021-09-13T11:03:54.000Z">
<meta property="article:modified_time" content="2023-07-27T05:14:56.461Z">
<meta property="article:author" content="Cheyennee">
<meta property="article:tag" content="blog">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cheyennee-blog.oss-cn-hangzhou.aliyuncs.com/images/handwrite/pic4.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://cheyennee.github.io/2021/09/13/%E6%89%8B%E5%86%99%E9%A2%98/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '手写题',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-07-27 13:14:56'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">44</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">1</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">19</div></a></div><hr/></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Cheyennee</a></span><div id="menus"><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">手写题</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-09-13T11:03:54.000Z" title="发表于 2021-09-13 19:03:54">2021-09-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-07-27T05:14:56.461Z" title="更新于 2023-07-27 13:14:56">2023-07-27</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%AE%97%E6%B3%95/">算法</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="手写题"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="post-content" id="article-container"><h4 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//实现：</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	首先搭建基本框架: 自定义Promise函数模块,使用立即执行的匿名函数书写模块</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">(<span class="keyword">function</span>(<span class="params"><span class="variable language_">window</span></span>)&#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    	构造函数,接收的参数为执行器函数（同步执行）</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">Promise</span>(<span class="params">executor</span>)&#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        	Promise的属性:</span></span><br><span class="line"><span class="comment">        	status: 给promise对象指定status属性，初始值为pending</span></span><br><span class="line"><span class="comment">        	data: 给promise对象指定一个用于存储结果数据的属性</span></span><br><span class="line"><span class="comment">        	callback: 回调队列，其中每个元素的结构为&#123;onResolved()&#123;&#125;, onRejected()&#123;&#125;&#125;</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">status</span> = <span class="string">&#x27;pending&#x27;</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">data</span> = <span class="literal">undefined</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">callback</span> = [];</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//这里必须使用箭头函数，因为函数里面的this需要指向Promise，而不是window</span></span><br><span class="line">        <span class="keyword">const</span> <span class="title function_">resolve</span> = value =&gt; &#123;</span><br><span class="line">            <span class="comment">//promise的状态只能修改一次</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="property">status</span>!==<span class="string">&#x27;pending&#x27;</span>)</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">status</span> = <span class="string">&#x27;resolved&#x27;</span>;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">data</span> = value;</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">            	如果有待执行callback函数，立即异步执行所有回调函数。这里有多个回调函数是因为用户可能会为一个promise指定多个then中的回调函数，这些回调函数均需执行。</span></span><br><span class="line"><span class="comment">            */</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="property">callback</span>.<span class="property">length</span>&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">                    <span class="variable language_">this</span>.<span class="property">callback</span>.<span class="title function_">forEach</span>(<span class="function"><span class="params">callbackObj</span>=&gt;</span>&#123;</span><br><span class="line">                        callbackObj.<span class="title function_">onResolved</span>(value);</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> <span class="title function_">reject</span> = reason =&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="property">status</span>!==<span class="string">&#x27;pending&#x27;</span>)</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">status</span> = <span class="string">&#x27;rejected&#x27;</span>;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">data</span> = reason;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="property">callback</span>.<span class="property">length</span>&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">                    <span class="variable language_">this</span>.<span class="property">callback</span>.<span class="title function_">forEach</span>(<span class="function"><span class="params">callbackObj</span>=&gt;</span>&#123;</span><br><span class="line">                        callbackObj.<span class="title function_">onRejected</span>(reason);</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="comment">//立即同步执行执行器函数</span></span><br><span class="line">            <span class="title function_">executor</span>(resolve, reject);</span><br><span class="line">        &#125;<span class="keyword">catch</span>(err)&#123;</span><br><span class="line">            <span class="title function_">reject</span>(err);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    	then方法指定成功和失败的回调函数，并且返回一个新的promise对象</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="title class_">Promise</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">then</span> = <span class="keyword">function</span>(<span class="params">onResolved, onRejected</span>)&#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        	指定回调函数的默认值必须是函数</span></span><br><span class="line"><span class="comment">        	onResolved向后传递成功的value</span></span><br><span class="line"><span class="comment">        	onRejected可以实现异常传透</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        onResolved = <span class="keyword">typeof</span> onResolved===<span class="string">&#x27;function&#x27;</span>?<span class="attr">onResolved</span>:<span class="function"><span class="params">value</span>=&gt;</span>value;</span><br><span class="line">        onRejected = <span class="keyword">typeof</span> onRejected===<span class="string">&#x27;function&#x27;</span>?<span class="attr">onRejected</span>:<span class="function"><span class="params">reason</span>=&gt;</span>&#123;<span class="keyword">throw</span> reason&#125;;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">const</span> that = <span class="variable language_">this</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">function</span> <span class="title function_">handle</span>(<span class="params">callback</span>)&#123;</span><br><span class="line">                <span class="keyword">try</span>&#123;</span><br><span class="line">                        <span class="keyword">const</span> res = <span class="title function_">callback</span>(that.<span class="property">data</span>);</span><br><span class="line">                        <span class="keyword">if</span>(res <span class="keyword">instanceof</span> <span class="title class_">Promise</span>)</span><br><span class="line">                            <span class="comment">//result是Promise对象，为了得到result的结果，必须使用then方法</span></span><br><span class="line">                            res.<span class="title function_">then</span>(resolve, reject);</span><br><span class="line">                        <span class="keyword">else</span></span><br><span class="line">                            <span class="title function_">resolve</span>(res);</span><br><span class="line">                    &#125;<span class="keyword">catch</span>(err)&#123;</span><br><span class="line">                        <span class="title function_">reject</span>(err);</span><br><span class="line">                    &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(that.<span class="property">status</span>===<span class="string">&#x27;pending&#x27;</span>)&#123;</span><br><span class="line">                <span class="comment">/*</span></span><br><span class="line"><span class="comment">                	若当前状态还是pending状态，将回调函数保存起来。不直接只传onResolved和onRejected是因为此处还需要修改新返回的promise的状态</span></span><br><span class="line"><span class="comment">                */</span></span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">callback</span>.<span class="title function_">push</span>(&#123;</span><br><span class="line">                    <span class="title function_">onResolved</span>(<span class="params"></span>)&#123;</span><br><span class="line">                        <span class="title function_">handle</span>(onResolved);</span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="title function_">onRejected</span>(<span class="params"></span>)&#123;</span><br><span class="line">                        <span class="title function_">handle</span>(onRejected);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(that.<span class="property">status</span>===<span class="string">&#x27;resolved&#x27;</span>)&#123;</span><br><span class="line">                <span class="comment">//因为回调函数是异步执行的，故此处需要setTimeout</span></span><br><span class="line">                <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">                    <span class="comment">/*</span></span><br><span class="line"><span class="comment">                    1.如果抛出异常，return的promise就失败，reason就是error</span></span><br><span class="line"><span class="comment">                    2.如果回调函数返回不是promise，return的promise就成功，value就是返回的值</span></span><br><span class="line"><span class="comment">                    3.如果回调函数返回是promise，return的promise结果就是这个promise</span></span><br><span class="line"><span class="comment">                    */</span></span><br><span class="line">                    <span class="title function_">handle</span>(onResolved);</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">                    <span class="title function_">handle</span>(onRejected);</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    	catch方法指定失败的回调函数，并且返回一个新的promise对象</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="title class_">Promise</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">catch</span> = <span class="keyword">function</span>(<span class="params">onRejected</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">then</span>(<span class="literal">undefined</span>, onRejected);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    	promise.finally方法用于指定不管promise对象最后状态如何,都会执行的操作.Promise.resolve执行回调，并在then中return结果传递给后面的Promise</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="title class_">Promise</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">finally</span> = <span class="keyword">function</span>(<span class="params">callback</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">then</span>(</span><br><span class="line">        	<span class="function"><span class="params">value</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="title function_">callback</span>()).<span class="title function_">then</span>(<span class="function">()=&gt;</span>value);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="function"><span class="params">reason</span>=&gt;</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="title function_">callback</span>()).<span class="title function_">then</span>(<span class="function">()=&gt;</span>&#123;<span class="keyword">throw</span> reason&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title class_">Promise</span>.<span class="property">resolve</span> = <span class="keyword">function</span>(<span class="params">value</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(value <span class="keyword">instanceof</span> <span class="title class_">Promise</span>)</span><br><span class="line">                value.<span class="title function_">then</span>(resolve, reject);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="title function_">resolve</span>(value);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title class_">Promise</span>.<span class="property">reject</span> = <span class="keyword">function</span>(<span class="params">reason</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="title function_">reject</span>(reason);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title class_">Promise</span>.<span class="property">race</span> = <span class="keyword">function</span>(<span class="params">promises</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(promises.<span class="property">length</span>===<span class="number">0</span>)</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            promises.<span class="title function_">forEach</span>(<span class="function"><span class="params">p</span>=&gt;</span>&#123;</span><br><span class="line">                <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(p).<span class="title function_">then</span>(</span><br><span class="line">                	<span class="function"><span class="params">value</span> =&gt;</span> &#123;<span class="title function_">resolve</span>(value)&#125;,</span><br><span class="line">                    <span class="function"><span class="params">reason</span> =&gt;</span> &#123;<span class="title function_">reject</span>(reason)&#125;</span><br><span class="line">                )</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//返回一个promise,只有当所有promise都成功时才成功，否则就失败</span></span><br><span class="line">    <span class="title class_">Promise</span>.<span class="property">all</span> = <span class="keyword">function</span>(<span class="params">promises</span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> values = <span class="keyword">new</span> <span class="title class_">Array</span>(promises.<span class="property">length</span>);</span><br><span class="line">        <span class="keyword">let</span> count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(promises.<span class="property">length</span>===<span class="number">0</span>)</span><br><span class="line">                <span class="title function_">resolve</span>([]);</span><br><span class="line">            promises.<span class="title function_">forEach</span>(<span class="function">(<span class="params">p, i</span>)=&gt;</span>&#123;</span><br><span class="line">                <span class="comment">//考虑到p可能是一个值的情况</span></span><br><span class="line">                <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(p).<span class="title function_">then</span>(</span><br><span class="line">                	<span class="function"><span class="params">value</span> =&gt;</span> &#123;</span><br><span class="line">                        count++;</span><br><span class="line">                        values[i] = value;</span><br><span class="line">                        <span class="keyword">if</span>(count===promises.<span class="property">length</span>)</span><br><span class="line">                            <span class="title function_">resolve</span>(values);</span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="function"><span class="params">reason</span> =&gt;</span> &#123;</span><br><span class="line">                        <span class="title function_">reject</span>(reason);</span><br><span class="line">                    &#125;</span><br><span class="line">                )</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title class_">Promise</span>.<span class="property">allSettled</span> = <span class="keyword">function</span>(<span class="params">promises</span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> values = <span class="keyword">new</span> <span class="title class_">Array</span>(promises.<span class="property">length</span>);</span><br><span class="line">        <span class="keyword">let</span> count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(promises.<span class="property">length</span>===<span class="number">0</span>)</span><br><span class="line">                <span class="title function_">resolve</span>([]);</span><br><span class="line">            promise.<span class="title function_">forEach</span>(<span class="function">(<span class="params">p, i</span>)=&gt;</span>&#123;</span><br><span class="line">                <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(p).<span class="title function_">then</span>(</span><br><span class="line">                	<span class="function"><span class="params">value</span>=&gt;</span>&#123;</span><br><span class="line">                        count++;</span><br><span class="line">                        values[i] = &#123;</span><br><span class="line">                        	<span class="attr">status</span>: <span class="string">&#x27;resolved&#x27;</span>,</span><br><span class="line">                            <span class="attr">data</span>: value</span><br><span class="line">                        &#125;;</span><br><span class="line">                        <span class="keyword">if</span>(count===promises.<span class="property">length</span>)</span><br><span class="line">                            <span class="title function_">resolve</span>(values);</span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="function"><span class="params">reason</span>=&gt;</span>&#123;</span><br><span class="line">                        count++;</span><br><span class="line">                        values[i]=&#123;</span><br><span class="line">                            <span class="attr">status</span>: <span class="string">&#x27;rejected&#x27;</span>,</span><br><span class="line">                            <span class="attr">data</span>: reason</span><br><span class="line">                        &#125;;</span><br><span class="line">                        <span class="keyword">if</span>(count===promises.<span class="property">length</span>)</span><br><span class="line">                            <span class="comment">//这里也是resolve</span></span><br><span class="line">                            <span class="title function_">resolve</span>(values);</span><br><span class="line">                    &#125;</span><br><span class="line">                )</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title class_">Promise</span>.<span class="property">any</span> = <span class="keyword">function</span>(<span class="params">promises</span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(promises.<span class="property">length</span>===<span class="number">0</span>)</span><br><span class="line">                <span class="title function_">resolve</span>([]);</span><br><span class="line">            promises.<span class="title function_">forEach</span>(<span class="function"><span class="params">p</span>=&gt;</span>&#123;</span><br><span class="line">                <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(p).<span class="title function_">then</span>(</span><br><span class="line">                	<span class="function"><span class="params">value</span>=&gt;</span>&#123;</span><br><span class="line">                        <span class="title function_">resolve</span>(value)</span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="function"><span class="params">reason</span>=&gt;</span>&#123;</span><br><span class="line">                        count++;</span><br><span class="line">                        <span class="keyword">if</span>(count===promises.<span class="property">length</span>)</span><br><span class="line">                            <span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">AggregateError</span>(<span class="string">&#x27;promises all fail!&#x27;</span>));</span><br><span class="line">                    &#125;</span><br><span class="line">                )</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//向外暴露Promise函数</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">Promise</span> = <span class="title class_">Promise</span>;</span><br><span class="line">&#125;)(<span class="variable language_">window</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--调用：--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;promise.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//如果是一般值，p1成功，value就是这个值</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> p1 = <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="number">2</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//如果是成功的promise,p2成功,value是这个promise的value</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> p2 = <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="number">3</span>));</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//如果是失败的promise,p3失败,reason是这个promise的reason</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> p3 = <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(<span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="number">4</span>));</span></span><br><span class="line"><span class="language-javascript">    p1.<span class="title function_">then</span>(<span class="function"><span class="params">value</span>=&gt;</span>&#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;p1&#x27;</span>, value)&#125;)<span class="comment">//p12</span></span></span><br><span class="line"><span class="language-javascript">    p2.<span class="title function_">then</span>(<span class="function"><span class="params">value</span>=&gt;</span>&#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;p2&#x27;</span>, value)&#125;)<span class="comment">//p23</span></span></span><br><span class="line"><span class="language-javascript">    p3.<span class="title function_">catch</span>(<span class="function"><span class="params">reason</span>=&gt;</span>&#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;p3&#x27;</span>, reason)&#125;)<span class="comment">//p34</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> pAll = <span class="title class_">Promise</span>.<span class="title function_">all</span>([p1, p2]);</span></span><br><span class="line"><span class="language-javascript">    pAll.<span class="title function_">then</span>(</span></span><br><span class="line"><span class="language-javascript">        <span class="function"><span class="params">values</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;race onResolved()&#x27;</span>, values);</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="function"><span class="params">reason</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;race onRejected()&#x27;</span>, reason);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    )</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> pRace = <span class="title class_">Promise</span>.<span class="title function_">race</span>([p1, p2, p3]);</span></span><br><span class="line"><span class="language-javascript">    pRace.<span class="title function_">then</span>(</span></span><br><span class="line"><span class="language-javascript">        <span class="function"><span class="params">value</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;race onResolved()&#x27;</span>, value);</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="function"><span class="params">reason</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;race onRejected()&#x27;</span>, reason);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    )</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> pAllsettled = <span class="title class_">Promise</span>.<span class="title function_">allSettled</span>([p1, p2, p3]);</span></span><br><span class="line"><span class="language-javascript">    pAllsettled.<span class="title function_">then</span>(</span></span><br><span class="line"><span class="language-javascript">        <span class="function"><span class="params">values</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;allsettled&#x27;</span>, values);</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="function"><span class="params">reason</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;allsettled&#x27;</span>, reason);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    )</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> pAny = <span class="title class_">Promise</span>.<span class="title function_">any</span>([p3]);</span></span><br><span class="line"><span class="language-javascript">    pAny.<span class="title function_">then</span>(</span></span><br><span class="line"><span class="language-javascript">        <span class="function"><span class="params">value</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;pany resolved&#x27;</span>, value);</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="function"><span class="params">reason</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;pany rejected&#x27;</span>, reason);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    )</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h4 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h4><p>数组排序算法的时间复杂度：<img src="https://cheyennee-blog.oss-cn-hangzhou.aliyuncs.com/images/handwrite/pic1.png" alt="时间复杂度图" style="zoom:50%;"></p>
<h5 id="数组排序"><a href="#数组排序" class="headerlink" title="数组排序"></a><em>数组排序</em></h5><p>数组排序：冒泡排序 o(n^2)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">bubbleSort</span>(<span class="params">arr</span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> len = arr.<span class="property">length</span>;</span><br><span class="line">    <span class="comment">//循环len轮，每一轮最大的数往后移</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;len;i++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> j=<span class="number">0</span>;j&lt;len-<span class="number">1</span>;j++)</span><br><span class="line">            <span class="keyword">if</span>(arr[j]&gt;arr[j+<span class="number">1</span>])</span><br><span class="line">                [arr[j], arr[j+<span class="number">1</span>]] = [arr[j+<span class="number">1</span>], arr[j]]</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>数组排序：选择排序 o(n^2)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">selectSort</span>(<span class="params">arr</span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> len = arr.<span class="property">length</span>;</span><br><span class="line">    <span class="keyword">let</span> minIndex;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;len-<span class="number">1</span>;i++)&#123;</span><br><span class="line">        minIndex = i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> j=i;j&lt;len;j++)</span><br><span class="line">            <span class="keyword">if</span>(arr[j]&lt;arr[minIndex])</span><br><span class="line">                minIndex = j;</span><br><span class="line">        <span class="keyword">if</span>(minIndex!==i)</span><br><span class="line">            [arr[i], arr[minIndex]] = [arr[minIndex], arr[i]]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>数组排序：插入排序 o(n^2)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">insertSort</span>(<span class="params">arr</span>)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">1</span>;i&lt;arr.<span class="property">length</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">let</span> j=i;</span><br><span class="line">        <span class="keyword">let</span> target = arr[j];</span><br><span class="line">        <span class="keyword">while</span>(j&gt;<span class="number">0</span>&amp;&amp;arr[j-<span class="number">1</span>]&gt;target)&#123;</span><br><span class="line">            arr[j]=arr[j-<span class="number">1</span>];</span><br><span class="line">            j--;</span><br><span class="line">        &#125;</span><br><span class="line">        arr[j] = target;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>数组排序：快速排序 o(nlogn-n^2)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">quickSort</span>(<span class="params">arr</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(arr.<span class="property">length</span>&lt;<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">return</span> arr;</span><br><span class="line">    <span class="keyword">let</span> cur = arr[arr.<span class="property">length</span>-<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">const</span> left = arr.<span class="title function_">filter</span>(<span class="function">(<span class="params">v, i</span>)=&gt;</span>v&lt;=cur&amp;&amp;i!==arr.<span class="property">length</span>-<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">const</span> right = arr.<span class="title function_">filter</span>(<span class="function"><span class="params">v</span>=&gt;</span>v&gt;cur);</span><br><span class="line">    <span class="keyword">return</span> [...<span class="title function_">quickSort</span>(left), cur, ...<span class="title function_">quickSort</span>(right)];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>数组排序：归并排序 o(nlogn)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">merge</span>(<span class="params">left, right</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> res = [];</span><br><span class="line">    <span class="keyword">let</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">let</span> j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(i&lt;left.<span class="property">length</span>&amp;&amp;j&lt;right.<span class="property">length</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(left[i]&lt;right[j])&#123;</span><br><span class="line">            res.<span class="title function_">push</span>(left[i]);</span><br><span class="line">            i++;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            res.<span class="title function_">push</span>(right[j]);</span><br><span class="line">            j++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(i&lt;left.<span class="property">length</span>)</span><br><span class="line">        res.<span class="title function_">push</span>(...left.<span class="title function_">slice</span>(i));</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        res.<span class="title function_">push</span>(...right.<span class="title function_">slice</span>(j));</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">mergeSort</span>(<span class="params">arr</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(arr.<span class="property">length</span>&lt;<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">return</span> arr;</span><br><span class="line">    <span class="keyword">const</span> mid = <span class="title class_">Math</span>.<span class="title function_">floor</span>(arr.<span class="property">length</span>/<span class="number">2</span>);</span><br><span class="line">    <span class="keyword">const</span> left = <span class="title function_">mergeSort</span>(arr.<span class="title function_">slice</span>(<span class="number">0</span>, mid));</span><br><span class="line">    <span class="keyword">const</span> right = <span class="title function_">mergeSort</span>(arr.<span class="title function_">slice</span>(mid));</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">merge</span>(left, right);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="数组去重"><a href="#数组去重" class="headerlink" title="数组去重"></a><em>数组去重</em></h5><p>数组去重：双重for+splice</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">unique</span>(<span class="params">arr</span>)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;arr.<span class="property">length</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> j=<span class="number">0</span>;j&lt;arr.<span class="property">length</span>;j++)</span><br><span class="line">            <span class="keyword">if</span>(arr[i]===arr[j])&#123;</span><br><span class="line">                arr.<span class="title function_">splice</span>(j, <span class="number">1</span>);</span><br><span class="line">                j--;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>数组去重：indexOf+新数组</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">unique</span>(<span class="params">arr</span>)&#123;</span><br><span class="line">	<span class="keyword">var</span> res = [];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;arr.<span class="property">length</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(res.<span class="title function_">indexOf</span>(arr[i])===-<span class="number">1</span>)</span><br><span class="line">            res.<span class="title function_">push</span>(arr[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>数组去重：快慢指针需要对数组进行排序，会打乱数组顺序</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">unique</span>(<span class="params">arr</span>)&#123;</span><br><span class="line">    arr.<span class="title function_">sort</span>(<span class="function">(<span class="params">a,b</span>)=&gt;</span>a-b);</span><br><span class="line">    <span class="keyword">let</span> slow = <span class="number">1</span>, fast = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(fast &lt; arr.<span class="property">length</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(arr[fast]!==arr[fast-<span class="number">1</span>])</span><br><span class="line">            arr[slow++]=arr[fast]</span><br><span class="line">        fast++;</span><br><span class="line">    &#125;</span><br><span class="line">    arr.<span class="property">length</span> = slow;</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>数组去重：ES6 set</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">unique</span>(<span class="params">arr</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> [...<span class="keyword">new</span> <span class="title class_">Set</span>(arr)];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>数组去重：map</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">unique</span>(<span class="params">arr</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> map = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line">    <span class="keyword">let</span> res = [];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;arr.<span class="property">length</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!map.<span class="title function_">has</span>(arr[i]))&#123;</span><br><span class="line">            map.<span class="title function_">set</span>(arr[i], <span class="literal">true</span>);</span><br><span class="line">            res.<span class="title function_">push</span>(arr[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>数组去重：filter</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">unique</span>(<span class="params">arr</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> arr.<span class="title function_">filter</span>(<span class="function">(<span class="params">item, index, arr</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> arr.<span class="title function_">indexOf</span>(item)===index;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>数组去重：reduce</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">unique</span>(<span class="params">arr</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> res = arr.<span class="title function_">reduce</span>(<span class="function">(<span class="params">acc, cur</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!acc.<span class="title function_">includes</span>(cur))</span><br><span class="line">            acc.<span class="title function_">push</span>(cur);</span><br><span class="line">        <span class="keyword">return</span> acc;</span><br><span class="line">    &#125;, []);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="数组实现-reduce与indexOf的参数与别的方法不一样"><a href="#数组实现-reduce与indexOf的参数与别的方法不一样" class="headerlink" title="数组实现: reduce与indexOf的参数与别的方法不一样"></a><em>数组实现</em>: reduce与indexOf的参数与别的方法不一样</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span>(<span class="params"><span class="variable language_">window</span></span>)&#123;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">Array</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">arr</span> = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">arr</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        forEach</span></span><br><span class="line"><span class="comment">        用途：调用数组的每个元素，执行一遍回调函数</span></span><br><span class="line"><span class="comment">        参数：(callback, thisValue),其中callback为回调函数,thisValue绑定this</span></span><br><span class="line"><span class="comment">        无返回值</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">forEach</span> = <span class="keyword">function</span>(<span class="params">callback</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">this</span>===<span class="literal">null</span>||<span class="variable language_">this</span>===<span class="literal">undefined</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TypeError</span>(<span class="string">&#x27;cannot read property forEach of null&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(callback)!==<span class="string">&#x27;[object Function]&#x27;</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TypeError</span>(<span class="string">&#x27;callback is not a function&#x27;</span>);</span><br><span class="line">        <span class="keyword">var</span> _arr = <span class="variable language_">this</span>.<span class="property">arr</span>, thisArg = <span class="variable language_">arguments</span>[<span class="number">1</span>]||<span class="variable language_">window</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;_arr.<span class="property">length</span>;i++)</span><br><span class="line">            callback.<span class="title function_">call</span>(thisArg, _arr[i], i, _arr);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        map</span></span><br><span class="line"><span class="comment">        用途：调用数组每个元素，并执行回调函数</span></span><br><span class="line"><span class="comment">        参数：(callback, thisArg)</span></span><br><span class="line"><span class="comment">        callback为回调函数，thisArg为回调函数的this指向</span></span><br><span class="line"><span class="comment">        返回值为每个回调函数返回值组成的数组</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">map</span> = <span class="keyword">function</span>(<span class="params">callback</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(callback)!==<span class="string">&#x27;[object Function]&#x27;</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TypeError</span>(<span class="string">&#x27;callback is not a function&#x27;</span>);</span><br><span class="line">        <span class="keyword">let</span> res = [];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;<span class="variable language_">this</span>.<span class="property">arr</span>.<span class="property">length</span>;i++)&#123;</span><br><span class="line">            <span class="keyword">let</span> tempres = callback.<span class="title function_">call</span>(<span class="variable language_">arguments</span>[<span class="number">1</span>]||<span class="variable language_">window</span>, <span class="variable language_">this</span>.<span class="property">arr</span>[i], i, <span class="variable language_">this</span>.<span class="property">arr</span>);</span><br><span class="line">            res.<span class="title function_">push</span>(tempres);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        reduce</span></span><br><span class="line"><span class="comment">        用途：调用数组的每个元素，并执行回调函数，将其结果返回为单个值</span></span><br><span class="line"><span class="comment">        参数：(callback, initValue)</span></span><br><span class="line"><span class="comment">        其中callback为回调函数，initValue为第一次调用时的初始值</span></span><br><span class="line"><span class="comment">        如果没有提供初始值，则使用数组第一个值，如果没有初始值并且空数组，则报错</span></span><br><span class="line"><span class="comment">        返回最终结果</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">reduce</span> = <span class="keyword">function</span>(<span class="params">callback</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(callback)!==<span class="string">&#x27;[object Function]&#x27;</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TypeError</span>(<span class="string">&#x27;callback is not a function&#x27;</span>);</span><br><span class="line">        <span class="keyword">var</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">var</span> acc = <span class="variable language_">arguments</span>[<span class="number">1</span>];</span><br><span class="line">        <span class="comment">//reduce函数接受的参数，包括一个callback还有一个初始化参数</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">arguments</span>[<span class="number">1</span>]===<span class="literal">undefined</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="property">arr</span>.<span class="property">length</span>===<span class="number">0</span>)</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;initval and array.length===0&#x27;</span>);</span><br><span class="line">            acc = <span class="variable language_">this</span>.<span class="property">arr</span>[i++];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(;i&lt;<span class="variable language_">this</span>.<span class="property">arr</span>.<span class="property">length</span>;i++)</span><br><span class="line">            acc = callback.<span class="title function_">call</span>(<span class="variable language_">this</span>, acc, <span class="variable language_">this</span>.<span class="property">arr</span>[i]);</span><br><span class="line">        <span class="keyword">return</span> acc;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        filter</span></span><br><span class="line"><span class="comment">        用途：调用数组每个元素，并执行回调函数</span></span><br><span class="line"><span class="comment">        参数：(callback, thisArg)</span></span><br><span class="line"><span class="comment">        callback为回调函数，thisArg为回调函数的this指向</span></span><br><span class="line"><span class="comment">        返回值为满足条件的数组元素组成的数组</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">    <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">filter</span> = <span class="keyword">function</span>(<span class="params">callback</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(callback)!==<span class="string">&#x27;[object Function]&#x27;</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TypeError</span>(<span class="string">&#x27;callback is not a function&#x27;</span>);</span><br><span class="line">        <span class="keyword">let</span> res = [];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;<span class="variable language_">this</span>.<span class="property">arr</span>.<span class="property">length</span>;i++)</span><br><span class="line">            <span class="keyword">if</span>(callback.<span class="title function_">call</span>(<span class="variable language_">arguments</span>[<span class="number">1</span>]||<span class="variable language_">window</span>, <span class="variable language_">this</span>.<span class="property">arr</span>[i], i, <span class="variable language_">this</span>.<span class="property">arr</span>))</span><br><span class="line">                res.<span class="title function_">push</span>(<span class="variable language_">this</span>.<span class="property">arr</span>[i]);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        find</span></span><br><span class="line"><span class="comment">        用途：返回数组中满足回调函数的第一个元素的值，否则返回undefined.注意！！！！是返回值，而不是索引！！！</span></span><br><span class="line"><span class="comment">        参数：(callback, thisArg)</span></span><br><span class="line"><span class="comment">        callback为回调函数，thisArg为回调函数的this指向</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">find</span> = <span class="keyword">function</span>(<span class="params">callback</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(callback)!==<span class="string">&#x27;[object Function]&#x27;</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TypeError</span>(<span class="string">&#x27;callback is not a function&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="property">arr</span>.<span class="property">length</span>===<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;<span class="variable language_">this</span>.<span class="property">arr</span>.<span class="property">length</span>;i++)</span><br><span class="line">            <span class="keyword">if</span>(callback.<span class="title function_">call</span>(<span class="variable language_">arguments</span>[<span class="number">1</span>]||<span class="variable language_">window</span>, <span class="variable language_">this</span>.<span class="property">arr</span>[i], i, <span class="variable language_">this</span>.<span class="property">arr</span>))</span><br><span class="line">                <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">arr</span>[i];</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">undefined</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        indexOf</span></span><br><span class="line"><span class="comment">        用途：返回数组中满足回调函数的第一个元素的值，否则返回-1</span></span><br><span class="line"><span class="comment">        参数：(findVal, beginIndex)</span></span><br><span class="line"><span class="comment">        findVal为需要查找的元素的值，beginIndex为查找的起始位置</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">indexOf</span> = <span class="keyword">function</span>(<span class="params">findVal, beginIndex=<span class="number">0</span></span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="property">arr</span>.<span class="property">length</span>&lt;<span class="number">1</span>||beginIndex&gt;<span class="variable language_">this</span>.<span class="property">arr</span>.<span class="property">length</span>)</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(!findVal)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        beginIndex=beginIndex&lt;=<span class="number">0</span>?<span class="number">0</span>:beginIndex;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;<span class="variable language_">this</span>.<span class="property">arr</span>.<span class="property">length</span>;i++)</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="property">arr</span>[i]===findVal)</span><br><span class="line">                <span class="keyword">return</span> i;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">Array</span> = <span class="title class_">Array</span>;</span><br><span class="line">&#125;)(<span class="variable language_">window</span>);</span><br></pre></td></tr></table></figure>

<h5 id="数组扁平化"><a href="#数组扁平化" class="headerlink" title="数组扁平化"></a><em>数组扁平化</em></h5><p>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const arr = [1, 2, 3, 4, [1, 2, 3, [1, 2, 3, [1, 2, 3]]], 5, &quot;string&quot;, &#123; name: &quot;弹铁蛋同学&quot; &#125;];</span><br></pre></td></tr></table></figure>

<p>代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// num 规定扁平化的层数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">flat</span>(<span class="params">arr, num=<span class="number">1</span></span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(num&lt;<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> arr;</span><br><span class="line">    <span class="keyword">return</span> num&gt;<span class="number">1</span></span><br><span class="line">    ?arr.<span class="title function_">reduce</span>(<span class="function">(<span class="params">pre, cur</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> pre.<span class="title function_">concat</span>(<span class="title class_">Array</span>.<span class="title function_">isArray</span>(cur)?<span class="title function_">flat</span>(cur, num-<span class="number">1</span>):cur)</span><br><span class="line">    &#125;, [])</span><br><span class="line">    :arr.<span class="title function_">slice</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="数组转树"><a href="#数组转树" class="headerlink" title="数组转树"></a><em>数组转树</em></h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">[&#123;<span class="attr">id</span>: , <span class="attr">pid</span>: &#125;, &#123;<span class="attr">id</span>: , <span class="attr">pid</span>: &#125;]</span><br><span class="line"></span><br><span class="line">[&#123;</span><br><span class="line">    <span class="attr">id</span>: ,</span><br><span class="line">    <span class="attr">children</span>: [&#123;</span><br><span class="line">        <span class="attr">pid</span>: ,</span><br><span class="line">        <span class="attr">id</span>: ,</span><br><span class="line">        <span class="attr">children</span>: []</span><br><span class="line">    &#125;,&#123;</span><br><span class="line">        <span class="attr">pid</span>: ,</span><br><span class="line">        <span class="attr">id</span>: ,</span><br><span class="line">        <span class="attr">children</span>: []</span><br><span class="line">    &#125;]</span><br><span class="line">&#125;,&#123;</span><br><span class="line">    <span class="attr">id</span>: ,</span><br><span class="line">    <span class="attr">children</span>: [&#123;</span><br><span class="line">        <span class="attr">pid</span>: ,</span><br><span class="line">        <span class="attr">id</span>: ,</span><br><span class="line">        <span class="attr">children</span>: []</span><br><span class="line">    &#125;,&#123;</span><br><span class="line">        <span class="attr">pid</span>: ,</span><br><span class="line">        <span class="attr">id</span>: ,</span><br><span class="line">        <span class="attr">children</span>: []</span><br><span class="line">    &#125;]</span><br><span class="line">&#125;]</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">arrayToTree</span>(<span class="params">items</span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> result = [];</span><br><span class="line">    <span class="keyword">const</span> itemMap = &#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">const</span> item <span class="keyword">of</span> items)&#123;</span><br><span class="line">        <span class="keyword">const</span> id = item.<span class="property">id</span>;</span><br><span class="line">        <span class="keyword">const</span> pid = item.<span class="property">pid</span>;</span><br><span class="line">        <span class="keyword">if</span>(!itemMap[id])</span><br><span class="line">            itemMap[id] = &#123;</span><br><span class="line">                <span class="attr">children</span>: []</span><br><span class="line">            &#125;</span><br><span class="line">        itemMap[id] = &#123;</span><br><span class="line">            ...item,</span><br><span class="line">            <span class="attr">children</span>: itemMap[id][<span class="string">&#x27;children&#x27;</span>]</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> treeItem = itemMap[id];</span><br><span class="line">        <span class="keyword">if</span>(pid===<span class="number">0</span>)</span><br><span class="line">            result.<span class="title function_">push</span>(treeItem);</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(!itemMap[pid])</span><br><span class="line">                itemMap[pid]=&#123;</span><br><span class="line">                    <span class="attr">children</span>: []</span><br><span class="line">                &#125;</span><br><span class="line">            itemMap[pid].<span class="property">children</span>.<span class="title function_">push</span>(treeItem);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><em><strong>树转数组</strong></em></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">treeToList</span>(<span class="params">data</span>)&#123;</span><br><span class="line">	<span class="keyword">let</span> res = [];</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">dfs</span> = tree=&gt;&#123;</span><br><span class="line">        tree.<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span>=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(item.<span class="property">children</span>)&#123;</span><br><span class="line">                <span class="title function_">dfs</span>(item.<span class="property">children</span>);</span><br><span class="line">                <span class="keyword">delete</span> item.<span class="property">children</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            res.<span class="title function_">push</span>(item);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">dfs</span>(data);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="类数组转化为数组"><a href="#类数组转化为数组" class="headerlink" title="类数组转化为数组"></a>类数组转化为数组</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[...arr];</span><br><span class="line"><span class="title class_">Array</span>.<span class="title function_">from</span>(arr);</span><br><span class="line"><span class="title class_">Array</span>.<span class="title function_">apply</span>(<span class="literal">null</span>, arr);</span><br><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">slice</span>.<span class="title function_">call</span>(arr);</span><br><span class="line"><span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">concat</span>.<span class="title function_">apply</span>([], arr);</span><br></pre></td></tr></table></figure>

<h3 id="防抖节流："><a href="#防抖节流：" class="headerlink" title="防抖节流："></a>防抖节流：</h3><ul>
<li>种类：非立即执行防抖节流和立即执行防抖节流</li>
</ul>
<p> 非立即执行防抖节流：</p>
<ul>
<li><p>事件触发-&gt;延时-&gt;执行回调函数</p>
</li>
<li><p>如果在延时阶段，继续触发事件，则会重新进行延时。在延时结束后执行回调函数。</p>
<p>立即执行防抖节流：（这种方法用户体验度更高）</p>
</li>
<li><p>事件触发-&gt;执行回调函数-&gt;延时</p>
</li>
<li><p>如果在延时中，继续触发事件，则会重新继续延时。在延时结束后，不再执行回调函数。clearTimeout能够取消setTimeout设定的延时事件的发生</p>
</li>
</ul>
<h4 id="防抖"><a href="#防抖" class="headerlink" title="防抖"></a>防抖</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">debounce</span>(<span class="params">func, wait, immediate</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> timeout, result;</span><br><span class="line">    <span class="keyword">var</span> debounced = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> context = <span class="variable language_">this</span>;</span><br><span class="line">        <span class="keyword">let</span> args = <span class="variable language_">arguments</span>;</span><br><span class="line">        <span class="keyword">if</span>(timeout)</span><br><span class="line">            <span class="built_in">clearTimeout</span>(timeout);</span><br><span class="line">        <span class="keyword">if</span>(immediate)&#123;</span><br><span class="line">            <span class="keyword">let</span> callnow = !timeout;</span><br><span class="line">            timeout = <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                timeout = <span class="literal">null</span>;</span><br><span class="line">            &#125;, wait);</span><br><span class="line">            <span class="keyword">if</span>(callnow)&#123;</span><br><span class="line">                result = func.<span class="title function_">apply</span>(context, args);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            timeout = <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                result = func.<span class="title function_">apply</span>(context, args);</span><br><span class="line">                timeout = <span class="literal">null</span>;</span><br><span class="line">            &#125;, wait);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;;</span><br><span class="line">    debounced.<span class="property">cancel</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="built_in">clearTimeout</span>(timeout);</span><br><span class="line">        timeout = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> debounced;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="节流"><a href="#节流" class="headerlink" title="节流"></a>节流</h4><p> 两种解决思路：1.类似debounce的方法2.采用时间戳的差</p>
<p> 两种解决方式的差异</p>
<ul>
<li><p>第一种先等待够规定时间，再执行</p>
</li>
<li><p>第二种先执行目标函数，再等待规定时间</p>
</li>
</ul>
<p> 有option选项，{leading: boolean, trailing: boolean}</p>
<ul>
<li><p>leading用于设置第一次是否执行</p>
</li>
<li><p>boolean用于设置最后一次是否执行</p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">throttle</span>(<span class="params">fn, wait, option</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> timeout;</span><br><span class="line">    <span class="keyword">let</span> old = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(!option)</span><br><span class="line">        option = &#123;&#125;;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> context = <span class="variable language_">this</span>;</span><br><span class="line">        <span class="keyword">let</span> args = <span class="variable language_">arguments</span>;</span><br><span class="line">        <span class="keyword">let</span> now = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>();</span><br><span class="line">        <span class="keyword">if</span>(!old&amp;&amp;option.<span class="property">leading</span>===<span class="literal">false</span>)</span><br><span class="line">            old = now;</span><br><span class="line">        <span class="keyword">let</span> remain = wait - (now - old);</span><br><span class="line">        <span class="keyword">if</span>(remain&lt;=<span class="number">0</span>||remain&gt;wait)&#123;</span><br><span class="line">            <span class="keyword">if</span>(timeout)&#123;</span><br><span class="line">                <span class="built_in">clearTimeout</span>(timeout);</span><br><span class="line">                timeout = <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            fn.<span class="title function_">apply</span>(context,args);</span><br><span class="line">            old = now;</span><br><span class="line">            <span class="comment">//这个地方不能再写timeout=....</span></span><br><span class="line">            <span class="comment">//因为如果写了，当option.trailing为true的话会进不去下面的语句</span></span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(!timeout &amp;&amp; option.<span class="property">trailing</span>)&#123;</span><br><span class="line">            timeout = <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">                fn.<span class="title function_">apply</span>(context, args);</span><br><span class="line">                timeout = <span class="literal">null</span>;</span><br><span class="line">                old = option.<span class="property">leading</span>===<span class="literal">false</span>?<span class="number">0</span>:<span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>()</span><br><span class="line">            &#125;, remain);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="setTimeout模拟setInterval"><a href="#setTimeout模拟setInterval" class="headerlink" title="setTimeout模拟setInterval"></a>setTimeout模拟setInterval</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> timer = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">myInterval</span>(<span class="params">func, wait</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> interv = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">func</span>();</span><br><span class="line">        timer = <span class="built_in">setTimeout</span>(interv, wait);</span><br><span class="line">    &#125;;</span><br><span class="line">    timer = <span class="built_in">setTimeout</span>(interv, wait);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//调用</span></span><br><span class="line"><span class="title function_">myInterval</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;, <span class="number">20</span>);</span><br></pre></td></tr></table></figure>

<h4 id="setInterval模拟setTimeout"><a href="#setInterval模拟setTimeout" class="headerlink" title="setInterval模拟setTimeout"></a>setInterval模拟setTimeout</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">mySetTimeout</span> = (<span class="params">fn, time</span>)=&gt;&#123;</span><br><span class="line">    interval = <span class="built_in">setInterval</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="title function_">fn</span>();</span><br><span class="line">        <span class="built_in">clearInterval</span>(interval);</span><br><span class="line">    &#125;, time);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Ajax"><a href="#Ajax" class="headerlink" title="Ajax"></a>Ajax</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">ajax</span>(<span class="params">&#123;url=<span class="literal">null</span>, method=<span class="string">&#x27;GET&#x27;</span>,dataType=<span class="string">&#x27;JSON&#x27;</span>,<span class="keyword">async</span>=<span class="literal">true</span>&#125;</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">        xhr.<span class="title function_">open</span>(method, url, <span class="keyword">async</span>);</span><br><span class="line">        xhr.<span class="property">responseType</span> = dataType;</span><br><span class="line">        xhr.<span class="property">onreadystatechange</span> = <span class="function">()=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(!(xhr.<span class="property">status</span>&gt;=<span class="number">200</span>&amp;&amp;xhr.<span class="property">status</span>&lt;<span class="number">300</span>))</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            <span class="keyword">if</span>(xhr.<span class="property">readyState</span>===<span class="number">4</span>)</span><br><span class="line">                <span class="title function_">resolve</span>(xhr.<span class="property">responseText</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        xhr.<span class="property">onerror</span> = <span class="function"><span class="params">err</span>=&gt;</span>&#123;</span><br><span class="line">            <span class="title function_">reject</span>(err);</span><br><span class="line">        &#125;</span><br><span class="line">        xhr.<span class="title function_">send</span>();</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="call"><a href="#call" class="headerlink" title="call"></a>call</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">call</span> = <span class="keyword">function</span>(<span class="params">context, ...args</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> context = context || <span class="variable language_">window</span>;</span><br><span class="line">    <span class="comment">//保存当前调用的函数</span></span><br><span class="line">    context.<span class="property">fn</span> = <span class="variable language_">this</span>;</span><br><span class="line">    <span class="keyword">let</span> res = context.<span class="title function_">fn</span>(...args);</span><br><span class="line">    <span class="keyword">delete</span> context.<span class="property">fn</span>;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="apply"><a href="#apply" class="headerlink" title="apply"></a>apply</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">apply</span> = <span class="keyword">function</span>(<span class="params">context, args</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> context = context || <span class="variable language_">window</span>;</span><br><span class="line">    context.<span class="property">fn</span> = <span class="variable language_">this</span>;</span><br><span class="line">    <span class="keyword">let</span> res;</span><br><span class="line">    <span class="keyword">if</span>(args)&#123;</span><br><span class="line">        res = context.<span class="title function_">fn</span>(...args);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        res = context.<span class="title function_">fn</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">delete</span> context.<span class="property">fn</span>;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="bind"><a href="#bind" class="headerlink" title="bind"></a>bind</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">bind</span> = <span class="keyword">function</span>(<span class="params">context, ...args1</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> context = context || <span class="variable language_">window</span>;</span><br><span class="line">    context.<span class="property">fn</span> = <span class="variable language_">this</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">...args2</span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> res;</span><br><span class="line">        <span class="keyword">if</span>(args1)</span><br><span class="line">            res = context.<span class="title function_">fn</span>(...args1);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            res = context.<span class="title function_">fn</span>(...args2);</span><br><span class="line">        <span class="keyword">delete</span> context.<span class="property">fn</span>;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>需要考虑柯里化以及new构造函数的问题：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">bind</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">// 取上下文</span></span><br><span class="line">    <span class="keyword">let</span> context = <span class="variable language_">arguments</span>[<span class="number">0</span>];</span><br><span class="line">    <span class="comment">// 取外部入参</span></span><br><span class="line">    <span class="keyword">let</span> outArgs = <span class="title class_">Array</span>.<span class="title function_">from</span>(<span class="variable language_">arguments</span>).<span class="title function_">slice</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="comment">// 存外部this,也就是需要调用的函数</span></span><br><span class="line">    <span class="keyword">let</span> outThis = <span class="variable language_">this</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">typeof</span> outThis !== <span class="string">&#x27;function&#x27;</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;the caller is not a function&#x27;</span>);</span><br><span class="line">    <span class="keyword">const</span> cb = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="comment">// 判断函数是否被new过</span></span><br><span class="line">        <span class="keyword">let</span> isNew = <span class="keyword">typeof</span> <span class="keyword">new</span>.<span class="property">target</span> !== <span class="string">&#x27;undefined&#x27;</span>;</span><br><span class="line">        <span class="comment">// 取内部入参</span></span><br><span class="line">        <span class="keyword">let</span> inArgs = <span class="title class_">Array</span>.<span class="title function_">from</span>(<span class="variable language_">arguments</span>);</span><br><span class="line">        <span class="comment">// 改变指向，合并函数入参</span></span><br><span class="line">        <span class="keyword">return</span> outThis.<span class="title function_">apply</span>(isNew?<span class="attr">this</span>:context, outArgs.<span class="title function_">concat</span>(inArgs));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 继承构造函数原型</span></span><br><span class="line">    cb.<span class="property"><span class="keyword">prototype</span></span> = outThis.<span class="property"><span class="keyword">prototype</span></span>;</span><br><span class="line">    <span class="keyword">return</span> cb;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="new"><a href="#new" class="headerlink" title="new"></a>new</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">new</span>(<span class="params">constructor, <span class="variable language_">arguments</span></span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> obj = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="literal">null</span>);</span><br><span class="line">    obj.<span class="property"><span class="keyword">prototype</span></span> = constructor.<span class="property"><span class="keyword">prototype</span></span>;</span><br><span class="line">    <span class="keyword">let</span> res = <span class="title class_">Object</span>.<span class="title function_">apply</span>(obj, <span class="variable language_">arguments</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">typeof</span> res === <span class="string">&#x27;object&#x27;</span>?<span class="attr">res</span>:obj;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="create"><a href="#create" class="headerlink" title="create"></a>create</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">create</span> = <span class="keyword">function</span>(<span class="params">proto, property</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(proto===<span class="literal">null</span>||<span class="keyword">typeof</span> proto!==<span class="string">&#x27;function&#x27;</span>&amp;&amp;<span class="keyword">typeof</span> proto!==<span class="string">&#x27;object&#x27;</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="title class_">TypeError</span>(<span class="string">&#x27;prototype should be an object&#x27;</span>);</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">F</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line">    F.<span class="property"><span class="keyword">prototype</span></span> = proto;</span><br><span class="line">    <span class="keyword">let</span> obj = <span class="keyword">new</span> <span class="title function_">F</span>();</span><br><span class="line">    <span class="keyword">if</span>(property)&#123;</span><br><span class="line">        <span class="title class_">Object</span>.<span class="title function_">keys</span>(property).<span class="title function_">forEach</span>(<span class="function"><span class="params">key</span>=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">let</span> value = property[key];</span><br><span class="line">            <span class="keyword">if</span>(key===<span class="literal">null</span>||<span class="keyword">typeof</span> key!==<span class="string">&#x27;object&#x27;</span>)</span><br><span class="line">                <span class="keyword">throw</span> <span class="title class_">TypeError</span>(<span class="string">&#x27;property should be an object&#x27;</span>);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(obj, key, value);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> obj;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="instanceof"><a href="#instanceof" class="headerlink" title="instanceof"></a>instanceof</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">instanceof</span>(<span class="params">left, right</span>)&#123;</span><br><span class="line">    <span class="keyword">while</span>(left)&#123;</span><br><span class="line">        <span class="keyword">if</span>(left.<span class="property">__proto__</span>===right.<span class="property"><span class="keyword">prototype</span></span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        left = left.<span class="property">__proto__</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Object-is"><a href="#Object-is" class="headerlink" title="Object.is"></a>Object.is</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    Object.is作用：比较两个值是否相等</span></span><br><span class="line"><span class="comment">    不同于==：Object.is不会将两个值进行类型转换</span></span><br><span class="line"><span class="comment">    不同于===: Object.is中Nan=Nan, +0!=-0，但在===中NaN!==Nan, +0=-0</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="property">is</span> = <span class="keyword">function</span>(<span class="params">x, y</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(x===y)</span><br><span class="line">        <span class="keyword">return</span> x!==<span class="number">0</span> || <span class="number">1</span>/x===<span class="number">1</span>/y;</span><br><span class="line">    <span class="keyword">return</span> x!==x&amp;&amp;y!==y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="deepclone"><a href="#deepclone" class="headerlink" title="deepclone"></a>deepclone</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">getType</span> = target=&gt;<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>.<span class="title function_">call</span>(target);</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">isObject</span> = target=&gt;target!==<span class="literal">null</span>&amp;&amp;(<span class="keyword">typeof</span> target===<span class="string">&#x27;object&#x27;</span>||<span class="keyword">typeof</span> target===<span class="string">&#x27;function&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> canTranverse = &#123;</span><br><span class="line">    <span class="string">&#x27;[object Object]&#x27;</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="string">&#x27;[object Map]&#x27;</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="string">&#x27;[object Set]&#x27;</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="string">&#x27;[object Array]&#x27;</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="string">&#x27;[object Argument]&#x27;</span>: <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleFunc</span> = target=&gt;&#123;</span><br><span class="line">    <span class="keyword">const</span> funcString = target.<span class="title function_">toString</span>();</span><br><span class="line">    <span class="comment">//有原型说明不是箭头函数</span></span><br><span class="line">    <span class="keyword">if</span>(target.<span class="property"><span class="keyword">prototype</span></span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> bodyexp = <span class="regexp">/(?&lt;=&#123;)(.|\n)+(?=&#125;)/</span>;</span><br><span class="line">        <span class="keyword">let</span> paramexp = <span class="regexp">/(?&lt;=\().+(?=\))\s+&#123;/</span>;</span><br><span class="line">        <span class="keyword">let</span> body = bodyexp.<span class="title function_">exec</span>(funcString)[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">let</span> param = paramexp.<span class="title function_">exec</span>(funcString)[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">if</span>(param)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Function</span>(...param, body);</span><br><span class="line">        &#125;<span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Function</span>(body);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">eval</span>(funcString);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleExp</span> = target=&gt;&#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;source, flags&#125; = target;</span><br><span class="line">    <span class="keyword">let</span> res = <span class="keyword">new</span> <span class="title class_">RegExp</span>(source, flag);</span><br><span class="line">    res.<span class="property">lastIndex</span> = target.<span class="property">lastIndex</span>;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handle</span> = (<span class="params">target, type</span>)=&gt;&#123;</span><br><span class="line">    <span class="keyword">switch</span>(type)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;[object Function]&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">handleFunc</span>(target);</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;[object RegExp]&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">hanldeExp</span>(target);</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;[object Error]&#x27;</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;[object Date]&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> target.<span class="title function_">constructor</span>(<span class="params">target</span>);</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;[object Boolean]&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Object</span>(<span class="title class_">Boolean</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">valueOf</span>.<span class="title function_">call</span>(target));</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;[object Number]&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Object</span>(<span class="title class_">Number</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">valueOf</span>.<span class="title function_">call</span>(target));</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;[object String]&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Object</span>(<span class="title class_">String</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">valueOf</span>.<span class="title function_">call</span>(target));</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;[object Symbol]&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Object</span>(<span class="title class_">Symbol</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">valueOf</span>.<span class="title function_">call</span>(target));</span><br><span class="line">        <span class="attr">default</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> target.<span class="title function_">constructor</span>(<span class="params">target</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//map是为了考虑循环引用的问题</span></span><br><span class="line"><span class="comment">//使用weakmap的理由：当我们要拷贝的对象过大时，使用Map会对内存造成很大的额外消耗，</span></span><br><span class="line"><span class="comment">//需要我们手动清除Map属性才能释放这块内存，但是WeakMap会自动回收这块内存</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">deepClone</span>(<span class="params">target, weakmap=<span class="keyword">new</span> <span class="built_in">WeakMap</span>()</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> type = <span class="title function_">getType</span>(target);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_">isObject</span>(type))</span><br><span class="line">        <span class="keyword">return</span> target;</span><br><span class="line">    <span class="keyword">let</span> cloneTarget;</span><br><span class="line">    <span class="keyword">if</span>(!canTranverse[type])</span><br><span class="line">        <span class="title function_">handle</span>(target, type);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        cloneTarget = <span class="keyword">new</span> target.<span class="title function_">constructor</span>(<span class="params"></span>);</span><br><span class="line">    <span class="keyword">if</span>(weakmap.<span class="title function_">get</span>(target))</span><br><span class="line">        <span class="keyword">return</span> target;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        weakmap.<span class="title function_">set</span>(target, <span class="literal">true</span>);</span><br><span class="line">    <span class="keyword">if</span>(type===<span class="string">&#x27;[object Array]&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> index <span class="keyword">in</span> target)</span><br><span class="line">            cloneTarget[index] = <span class="title function_">deepClone</span>(target[index],weakmap);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(type===<span class="string">&#x27;[object Map]&#x27;</span>)&#123;</span><br><span class="line">        <span class="title class_">Object</span>.<span class="title function_">keys</span>(target).<span class="title function_">forEach</span>(<span class="function"><span class="params">key</span>=&gt;</span>&#123;</span><br><span class="line">            cloneTarget.<span class="title function_">set</span>(<span class="title function_">deepClone</span>(key, weakmap), <span class="title function_">deepClone</span>(target[key], weakmap));</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(type===<span class="string">&#x27;[object Set]&#x27;</span>)&#123;</span><br><span class="line">        target.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item, key</span>)=&gt;</span>&#123;</span><br><span class="line">            cloneTarget.<span class="title function_">add</span>(key, <span class="title function_">deepClone</span>(item, weakmap));</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cloneTarget;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h3><h4 id="原型链继承"><a href="#原型链继承" class="headerlink" title="原型链继承"></a>原型链继承</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Father</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">property</span> = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Father</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">getFatherValue</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">property</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Son</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">subproperty</span> = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Son</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="keyword">new</span> <span class="title class_">Father</span>();</span><br><span class="line"><span class="title class_">Son</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">getSonValue</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">subproperty</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> instance = <span class="keyword">new</span> <span class="title class_">Son</span>();</span><br><span class="line">instance.<span class="title function_">getFatherValue</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	缺点：</span></span><br><span class="line"><span class="comment">	1.	在父类型构造函数中定义的引用类型值的实例属性，会在子类型原型上变成原型属性被所有子类型实例所共享</span></span><br><span class="line"><span class="comment">	2.	在创建子类型的实例时，不能向父类型的构造函数中传递参数</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<h4 id="构造函数式继承"><a href="#构造函数式继承" class="headerlink" title="构造函数式继承"></a>构造函数式继承</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Father</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">colors</span> = [<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;green&#x27;</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Son</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">//通过使用apply或call，实际上是在将要创建的Son实例的环境下调用了Father构造函数</span></span><br><span class="line">    <span class="title class_">Father</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> instance = <span class="keyword">new</span> <span class="title class_">Son</span>();</span><br><span class="line">instance.<span class="property">colors</span>.<span class="title function_">push</span>(<span class="string">&#x27;purple&#x27;</span>);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	优点：解决了原型链继承的缺点。</span></span><br><span class="line"><span class="comment">	缺点：方法都在构造函数中定义，无法实现函数复用。父类型的原型中定义的方法，对子类型而言是不可见的，结果所有类型都只能使用构造函数模式。</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<h4 id="组合式继承"><a href="#组合式继承" class="headerlink" title="组合式继承"></a>组合式继承</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Father</span>(<span class="params">name</span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">colors</span> = [<span class="string">&#x27;red&#x27;</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Father</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sayName</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="variable language_">this</span>.<span class="property">name</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Son</span>(<span class="params">name, age</span>)&#123;</span><br><span class="line">    <span class="title class_">Father</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>, name);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Son</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="keyword">new</span> <span class="title class_">Father</span>();</span><br><span class="line"><span class="title class_">Son</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span> = <span class="title class_">Son</span>;</span><br><span class="line"><span class="title class_">Son</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sayAge</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="variable language_">this</span>.<span class="property">age</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> instance = <span class="keyword">new</span> <span class="title class_">Son</span>(<span class="string">&#x27;aaa&#x27;</span>, <span class="number">12</span>);</span><br><span class="line">instance.<span class="property">colors</span>.<span class="title function_">push</span>(<span class="string">&#x27;purple&#x27;</span>);</span><br><span class="line"><span class="comment">//缺点：无论在什么情况下，都会调用两次超类型构造函数：一次是在创建子类型原型的时候，另一次是在子类型构造函数内部</span></span><br></pre></td></tr></table></figure>

<h4 id="原型式继承-浅拷贝"><a href="#原型式继承-浅拷贝" class="headerlink" title="原型式继承,浅拷贝"></a>原型式继承,浅拷贝</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//方法一</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">object</span>(<span class="params">o</span>)&#123;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">F</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line">    F.<span class="property"><span class="keyword">prototype</span></span> = o;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title function_">F</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//方法二</span></span><br><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;hh&#x27;</span>,</span><br><span class="line">    <span class="attr">colors</span>: [<span class="string">&#x27;red&#x27;</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> anotherPerson = <span class="title class_">Object</span>.<span class="title function_">create</span>(person, &#123;</span><br><span class="line">    <span class="attr">name</span>: &#123;</span><br><span class="line">        <span class="attr">value</span>: <span class="string">&#x27;tom&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//缺点：包含引用类型值的属性始终会在所有实例中共享相同的值</span></span><br></pre></td></tr></table></figure>

<h4 id="寄生式继承"><a href="#寄生式继承" class="headerlink" title="寄生式继承"></a>寄生式继承</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">createPerson</span>(<span class="params">original</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> clone = <span class="title class_">Object</span>.<span class="title function_">create</span>(original);</span><br><span class="line">    clone.<span class="property">sayGood</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&#x27;hello world&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> clone;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//原理：在函数内部以某种方式来增强对象，最后返回对象</span></span><br><span class="line"><span class="comment">//缺点：函数难以复用</span></span><br></pre></td></tr></table></figure>

<h4 id="寄生组合式继承"><a href="#寄生组合式继承" class="headerlink" title="寄生组合式继承"></a>寄生组合式继承</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Father</span>(<span class="params">name</span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">colors</span> = [<span class="string">&#x27;red&#x27;</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Father</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sayName</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="variable language_">this</span>.<span class="property">name</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Son</span>(<span class="params">name, age</span>)&#123;</span><br><span class="line">    <span class="title class_">Father</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>, name);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> anotherPrototype = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="title class_">Father</span>.<span class="property"><span class="keyword">prototype</span></span>);</span><br><span class="line">anotherPrototype.<span class="property">constructor</span> = <span class="title class_">Son</span>;</span><br><span class="line"><span class="title class_">Son</span>.<span class="property"><span class="keyword">prototype</span></span> = anotherPrototype;</span><br><span class="line"><span class="title class_">Son</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sayAge</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="variable language_">this</span>.<span class="property">age</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> instance = <span class="keyword">new</span> <span class="title class_">Son</span>(<span class="string">&#x27;lu&#x27;</span>, <span class="number">22</span>);</span><br></pre></td></tr></table></figure>

<h4 id="大数相加"><a href="#大数相加" class="headerlink" title="大数相加"></a>大数相加</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">add</span>(<span class="params">a, b</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> maxlength = <span class="title class_">Math</span>.<span class="title function_">max</span>(a.<span class="property">length</span>, b.<span class="property">length</span>);</span><br><span class="line">    a = a.<span class="title function_">padStart</span>(maxlength, <span class="number">0</span>);</span><br><span class="line">    b = b.<span class="title function_">padStart</span>(maxlength, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">let</span> t = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">let</span> f = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">let</span> sum = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i=maxlength-<span class="number">1</span>;i&gt;=<span class="number">0</span>;i--)&#123;</span><br><span class="line">        t = <span class="built_in">parseInt</span>(a[i])+<span class="built_in">parseInt</span>(b[i])+f;</span><br><span class="line">        f = <span class="title class_">Math</span>.<span class="title function_">floor</span>(t/<span class="number">10</span>);</span><br><span class="line">        sum = t%<span class="number">10</span>+sum;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(f!=<span class="number">0</span>)</span><br><span class="line">        sum=<span class="string">&#x27;&#x27;</span>+f+sum;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="表单校验"><a href="#表单校验" class="headerlink" title="表单校验"></a>表单校验</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> strategies = &#123;</span><br><span class="line">    <span class="attr">isNoEmpty</span>: <span class="keyword">function</span>(<span class="params">value, errorMsg</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (value === <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> errorMsg;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">minLength</span>: <span class="keyword">function</span>(<span class="params">value, length, errorMsg</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(value.<span class="property">length</span>&lt;length)</span><br><span class="line">            <span class="keyword">return</span> errorMsg;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">isMobile</span>: <span class="keyword">function</span>(<span class="params">value, errorMsg</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="regexp">/^$/</span>.<span class="title function_">test</span>(value))</span><br><span class="line">            <span class="keyword">return</span> errorMsg;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Validator</span>&#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">cache</span> = [];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">add</span>(<span class="params">dom, rules</span>)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>,rule;rule=rules[i++];)&#123;</span><br><span class="line">            <span class="keyword">let</span> strategyAry = rule.<span class="property">strategy</span>.<span class="title function_">split</span>(<span class="string">&#x27;:&#x27;</span>);</span><br><span class="line">            <span class="keyword">let</span> errorMsg = rule.<span class="property">errorMsg</span>;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">cache</span>.<span class="title function_">push</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">                <span class="keyword">let</span> strategy = strategyAry.<span class="title function_">shift</span>();</span><br><span class="line">                strategyAry.<span class="title function_">unshift</span>(dom.<span class="property">value</span>);</span><br><span class="line">                strategyAry.<span class="title function_">push</span>(errorMsg);</span><br><span class="line">                <span class="keyword">return</span> strategies[strategy].<span class="title function_">apply</span>(dom, strategyAry);</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">start</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>,validatorFunc;validatorFunc=<span class="variable language_">this</span>.<span class="property">cache</span>[i++];)&#123;</span><br><span class="line">            <span class="keyword">let</span> errorMsg = <span class="title function_">validatorFunc</span>();</span><br><span class="line">            <span class="keyword">if</span>(errorMsg)</span><br><span class="line">                <span class="keyword">return</span> errorMsg;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> registerForm = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;registerForm&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> validateFunc = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> validator = <span class="keyword">new</span> <span class="title class_">Validator</span>();</span><br><span class="line">    validator.<span class="title function_">add</span>(registerForm.<span class="property">username</span>, [&#123;</span><br><span class="line">        <span class="attr">strategy</span>: <span class="string">&#x27;isNoEmpty&#x27;</span>,</span><br><span class="line">        <span class="attr">errorMsg</span>: <span class="string">&#x27;cannot input empty&#x27;</span></span><br><span class="line">    &#125;,&#123;</span><br><span class="line">        <span class="attr">strategy</span>: <span class="string">&#x27;minLength:2&#x27;</span>,</span><br><span class="line">        <span class="attr">errorMsg</span>: <span class="string">&#x27;input is too short&#x27;</span></span><br><span class="line">    &#125;])</span><br><span class="line">    validator.<span class="title function_">add</span>(registerForm.<span class="property">mobile</span>, [&#123;</span><br><span class="line">        <span class="attr">strategy</span>: <span class="string">&#x27;isMobile&#x27;</span>,</span><br><span class="line">        <span class="attr">errorMsg</span>: <span class="string">&#x27;mobile is invalid&#x27;</span></span><br><span class="line">    &#125;])</span><br><span class="line">    <span class="keyword">return</span> validator.<span class="title function_">start</span>();</span><br><span class="line">&#125;</span><br><span class="line">registerForm.<span class="property">onsubmit</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> errorMsg = <span class="title function_">validateFunc</span>();</span><br><span class="line">    <span class="keyword">if</span>(errorMsg)</span><br><span class="line">        <span class="title function_">alert</span>(errorMsg);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="发布订阅者模式"><a href="#发布订阅者模式" class="headerlink" title="发布订阅者模式"></a>发布订阅者模式</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">EventEmitter</span>&#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">events</span> = &#123;&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//on: 实现订阅</span></span><br><span class="line">    <span class="title function_">on</span>(<span class="params">type, callback</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="variable language_">this</span>.<span class="property">events</span>[type])</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">events</span>[type] = [callback];</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">events</span>[type].<span class="title function_">push</span>(callback);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">off</span>(<span class="params">type, callback</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="variable language_">this</span>.<span class="property">events</span>[type])</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">events</span>[type] = <span class="variable language_">this</span>.<span class="property">events</span>[type].<span class="title function_">filter</span>(<span class="function"><span class="params">item</span>=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> item!=callback;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">once</span>(<span class="params">type, callback</span>)&#123;</span><br><span class="line">        <span class="comment">//在执行完callback函数之后，立马将其移除</span></span><br><span class="line">        <span class="comment">//因为这两个步骤需要捆绑先后执行，所以需要将它们打包在一个函数中加入数组</span></span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">callback</span>();</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">off</span>(type, fn);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">on</span>(type, fn);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">emit</span>(<span class="params">type, ...rest</span>)&#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">events</span>[type]&amp;&amp;<span class="variable language_">this</span>.<span class="property">events</span>[type].<span class="title function_">forEach</span>(<span class="function"><span class="params">fn</span>=&gt;</span>fn.<span class="title function_">apply</span>(<span class="variable language_">this</span>, rest));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//调用</span></span><br><span class="line"><span class="keyword">const</span> event = <span class="keyword">new</span> <span class="title class_">EventEmitter</span>();</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handle</span> = (<span class="params">...rest</span>)=&gt;&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(rest);</span><br><span class="line">&#125;</span><br><span class="line">event.<span class="title function_">on</span>(<span class="string">&#x27;click&#x27;</span>, handle);</span><br><span class="line">event.<span class="title function_">emit</span>(<span class="string">&#x27;click&#x27;</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>);</span><br><span class="line">event.<span class="title function_">off</span>(<span class="string">&#x27;click&#x27;</span>, handle);</span><br></pre></td></tr></table></figure>

<h4 id="小数据：分片渲染大数据量数据-requestAnimationFrame版"><a href="#小数据：分片渲染大数据量数据-requestAnimationFrame版" class="headerlink" title="小数据：分片渲染大数据量数据 requestAnimationFrame版"></a>小数据：分片渲染大数据量数据 requestAnimationFrame版</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> ul = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;container&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> total = <span class="number">100000</span>;</span><br><span class="line"><span class="keyword">let</span> once = <span class="number">20</span>;</span><br><span class="line"><span class="keyword">let</span> index = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">loop</span>(<span class="params">curTotal, curIndex</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(curTotal&lt;=<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">let</span> pageCount = <span class="title class_">Math</span>.<span class="title function_">min</span>(curTotal, once);</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">requestAnimationFrame</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;pageCount;i++)&#123;</span><br><span class="line">            <span class="keyword">let</span> li = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;li&#x27;</span>);</span><br><span class="line">            li.<span class="property">innerText</span> = curIndex+i+<span class="string">&quot;:&quot;</span>+~~(<span class="title class_">Math</span>.<span class="title function_">random</span>()*total);</span><br><span class="line">            ul.<span class="title function_">appendChild</span>(li);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="title function_">loop</span>(curTotal-pageCount, curIndex+pageCount);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">loop</span>(total, index);</span><br></pre></td></tr></table></figure>

<h4 id="DocumentFragment版"><a href="#DocumentFragment版" class="headerlink" title="DocumentFragment版"></a>DocumentFragment版</h4><p>DocumentFragment，文档片段接口，表示一个没有父级文件的最小文档对象。它被作为一个轻量版的<code>Document</code>使用，用于存储已排好版的或尚未打理好格式的XML片段。最大的区别是因为<code>DocumentFragment</code><strong>不是真实DOM树的一部分，它的变化不会触发DOM树的（重新渲染) ，且不会导致性能等问题。</strong>可以使用<code>document.createDocumentFragment</code>方法或者构造函数来创建一个空的DocumentFragment。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> ul = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;container&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> total = <span class="number">100000</span>;</span><br><span class="line"><span class="keyword">let</span> once = <span class="number">20</span>;</span><br><span class="line"><span class="keyword">let</span> index = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">loop</span>(<span class="params">curTotal, curIndex</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(curTotal&lt;=<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">let</span> pageCount = <span class="title class_">Math</span>.<span class="title function_">min</span>(curTotal, once);</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">requestAnimationFrame</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> fragment = <span class="variable language_">document</span>.<span class="title function_">createDocumentFragment</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;pageCount;i++)&#123;</span><br><span class="line">            <span class="keyword">let</span> li = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;li&#x27;</span>);</span><br><span class="line">            li.<span class="property">innerText</span> = curIndex+i+<span class="string">&quot;:&quot;</span>+~~(<span class="title class_">Math</span>.<span class="title function_">random</span>()*total);</span><br><span class="line">            fragment.<span class="title function_">appendChild</span>(li);</span><br><span class="line">        &#125;</span><br><span class="line">        ul.<span class="title function_">appendChild</span>(fragment);</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="title function_">loop</span>(curTotal-pageCount, curIndex+pageCount);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">loop</span>(total, index);</span><br></pre></td></tr></table></figure>

<h4 id="模板字符串解析"><a href="#模板字符串解析" class="headerlink" title="模板字符串解析"></a>模板字符串解析</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    let template = &#x27;我是&#123;&#123;name&#125;&#125;，年龄&#123;&#123;age&#125;&#125;，性别&#123;&#123;sex&#125;&#125;&#x27;;</span></span><br><span class="line"><span class="comment">    let data = &#123;</span></span><br><span class="line"><span class="comment">    name: &#x27;姓名&#x27;,</span></span><br><span class="line"><span class="comment">    age: 18</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    render(template, data); // 我是姓名，年龄18，性别undefined</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">render</span>(<span class="params">template, data</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> computed = template.<span class="title function_">replace</span>(<span class="regexp">/\&#123;\&#123;(\w+)\&#125;\&#125;/g</span>, <span class="keyword">function</span>(<span class="params">match, key</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> data[key];</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> computed;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="LRUcache"><a href="#LRUcache" class="headerlink" title="LRUcache"></a>LRUcache</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">LRUcache</span>&#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">capacity</span>)&#123;</span><br><span class="line">        <span class="comment">//使用map是因为map不仅能记录key和value，还能记录插入顺序</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">secretKey</span> = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">capacity</span> = capacity;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">get</span>(<span class="params">key</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="property">secretKey</span>.<span class="title function_">has</span>(key))&#123;</span><br><span class="line">            <span class="keyword">let</span> tempValue = <span class="variable language_">this</span>.<span class="property">secretKey</span>.<span class="title function_">get</span>(key);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">secretKey</span>.<span class="title function_">delete</span>(key);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">secretKey</span>.<span class="title function_">set</span>(key, tempValue);</span><br><span class="line">            <span class="keyword">return</span> tempValue;</span><br><span class="line">        &#125;<span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">put</span>(<span class="params">key, value</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="property">secretKey</span>.<span class="title function_">has</span>(key))&#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">secretKey</span>.<span class="title function_">delete</span>(key);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">secretKey</span>.<span class="title function_">set</span>(key, value);</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="property">secretKey</span>.<span class="property">size</span>&lt;<span class="variable language_">this</span>.<span class="property">capacity</span>)</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">secretKey</span>.<span class="title function_">set</span>(key, value);</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">secretKey</span>.<span class="title function_">set</span>(key, value);</span><br><span class="line">            <span class="comment">//keys()返回一个引用的Iterator对象</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">secretKey</span>.<span class="title function_">delete</span>(<span class="variable language_">this</span>.<span class="property">secretKey</span>.<span class="title function_">keys</span>().<span class="title function_">next</span>().<span class="property">value</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="LazyMan"><a href="#LazyMan" class="headerlink" title="LazyMan"></a>LazyMan</h4><p>场景</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">实现一个LazyMan，可以按照以下方式调用:</span><br><span class="line">LazyMan(“Hank”)输出:</span><br><span class="line">Hi! This is Hank!</span><br><span class="line"></span><br><span class="line">LazyMan(“Hank”).sleep(10).eat(“dinner”)输出</span><br><span class="line">Hi! This is Hank!</span><br><span class="line">//等待10秒..</span><br><span class="line">Wake up after 10</span><br><span class="line">Eat dinner~</span><br><span class="line"></span><br><span class="line">LazyMan(“Hank”).eat(“dinner”).eat(“supper”)输出</span><br><span class="line">Hi This is Hank!</span><br><span class="line">Eat dinner~</span><br><span class="line">Eat supper~</span><br><span class="line"></span><br><span class="line">LazyMan(“Hank”).eat(“supper”).sleepFirst(5)输出</span><br><span class="line">//等待5秒</span><br><span class="line">Wake up after 5</span><br><span class="line">Hi This is Hank!</span><br><span class="line">Eat supper</span><br></pre></td></tr></table></figure>

<p>代码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">_LazyMan</span>&#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">name</span>)&#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">tasks</span> = [];</span><br><span class="line">        <span class="keyword">const</span> <span class="title function_">task</span> = (<span class="params"></span>)=&gt;&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`hi! this is <span class="subst">$&#123;name&#125;</span>`</span>);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">next</span>();</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">tasks</span>.<span class="title function_">push</span>(task);</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">next</span>();</span><br><span class="line">        &#125;, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">next</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">const</span> task = <span class="variable language_">this</span>.<span class="property">tasks</span>.<span class="title function_">shift</span>();</span><br><span class="line">        task &amp;&amp; <span class="title function_">task</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="params">time</span>)&#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">_sleepWrapper</span>(time, <span class="literal">false</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">sleepFirst</span>(<span class="params">time</span>)&#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">_sleepWrapper</span>(time, <span class="literal">false</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">_sleepWrapper</span>(<span class="params">time, first</span>)&#123;</span><br><span class="line">        <span class="keyword">const</span> <span class="title function_">task</span> = (<span class="params"></span>)=&gt;&#123;</span><br><span class="line">            <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`wake up after <span class="subst">$&#123;time&#125;</span>`</span>);</span><br><span class="line">                <span class="variable language_">this</span>.<span class="title function_">next</span>();</span><br><span class="line">            &#125;, time*<span class="number">1000</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(first)</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">tasks</span>.<span class="title function_">unshift</span>(task);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">tasks</span>.<span class="title function_">push</span>(task);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">eat</span>(<span class="params">name</span>)&#123;</span><br><span class="line">        <span class="keyword">const</span> <span class="title function_">task</span> = (<span class="params"></span>)=&gt;&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Eat <span class="subst">$&#123;name&#125;</span>`</span>);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">next</span>();</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">tasks</span>.<span class="title function_">push</span>(task);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">LazyMan</span>(<span class="params">name</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title function_">_LazyMan</span>(name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="compose"><a href="#compose" class="headerlink" title="compose"></a>compose</h4><p>场景</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">compose 是函数式编程中很重要的函数之一。</span><br><span class="line">compose 函数的作用就是组合函数的，将函数串联起来执行，将多个函数组合起来，</span><br><span class="line">一个函数的输出结果是另一个函数的输入参数，一旦第一个函数开始执行，</span><br><span class="line">就会像多米诺骨牌一样推导执行了。</span><br><span class="line">compose(f,g,m,n)(x) === f(g(m(n(x))))</span><br></pre></td></tr></table></figure>

<p>代码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//迭代方式实现</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">compose1</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> fns = [].<span class="property">slice</span>.<span class="title function_">call</span>(<span class="variable language_">arguments</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">initArg</span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> res = initArg;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i=fns.<span class="property">length</span>-<span class="number">1</span>;i&gt;=<span class="number">0</span>;i--)</span><br><span class="line">            res = fns[i](res);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//reduce方法实现</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">compose2</span>(<span class="params">...funcs</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(funcs.<span class="property">length</span>===<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="params">v</span>=&gt;</span>v;</span><br><span class="line">    <span class="keyword">if</span>(funcs.<span class="property">length</span>===<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> funcs[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">return</span> funcs.<span class="title function_">reduce</span>(<span class="function">(<span class="params">a, b</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">...args</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">a</span>(<span class="title function_">b</span>(...args));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="curry"><a href="#curry" class="headerlink" title="curry"></a>curry</h4><p>场景</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">所谓”柯里化”，简单来说就是把一个多参数的函数，转化为单参数函数</span><br><span class="line">// 普通的add函数</span><br><span class="line">function add(x, y) &#123;</span><br><span class="line">	return x + y</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Currying后</span><br><span class="line">function curryingAdd(x) &#123;</span><br><span class="line">    return function (y) &#123;</span><br><span class="line">    return x + y</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">add(1, 2)           // 3</span><br><span class="line">curryingAdd(1)(2)   // 3</span><br></pre></td></tr></table></figure>

<p>代码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">currying</span>(<span class="params">fn, ...args</span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> length = fn.<span class="property">length</span>;</span><br><span class="line">    <span class="keyword">let</span> allargs = [...args];</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">res</span> = (<span class="params">...newArgs</span>)=&gt;&#123;</span><br><span class="line">        allargs = [...allargs, ...newArgs];</span><br><span class="line">        <span class="keyword">if</span>(allargs.<span class="property">length</span> === length)</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">fn</span>(...allargs);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="add"><a href="#add" class="headerlink" title="add"></a>add</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">add</span>(<span class="params">...args</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> allargs = [...args];</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params">...args2</span>)&#123;</span><br><span class="line">        allargs = [...allargs, ...args2];</span><br><span class="line">        <span class="keyword">return</span> fn;</span><br><span class="line">    &#125;</span><br><span class="line">    fn.<span class="property">toString</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!allargs.<span class="property">length</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">return</span> allargs.<span class="title function_">reduce</span>(<span class="function">(<span class="params">sum, cur</span>)=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> sum+cur;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> fn;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="通用事件侦听器函数"><a href="#通用事件侦听器函数" class="headerlink" title="通用事件侦听器函数"></a>通用事件侦听器函数</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">EventUtils</span> = &#123;</span><br><span class="line">    <span class="attr">addEvent</span>: <span class="keyword">function</span>(<span class="params">element, type, handler</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(element.<span class="property">addEventListener</span>)<span class="comment">//DOM2</span></span><br><span class="line">            element.<span class="title function_">addEventListener</span>(type, handler, <span class="literal">false</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(element.<span class="property">attachEvent</span>)<span class="comment">//IE</span></span><br><span class="line">            element.<span class="title function_">attachEvent</span>(<span class="string">&quot;on&quot;</span>+type, handler);</span><br><span class="line">        <span class="keyword">else</span><span class="comment">//DOM0</span></span><br><span class="line">            element[<span class="string">&quot;on&quot;</span>+type]=handler;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">removeEvent</span>: <span class="keyword">function</span>(<span class="params">element, type, handler</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(element.<span class="property">removeEventListener</span>)</span><br><span class="line">            element.<span class="title function_">removeEventListener</span>(type, handler, <span class="literal">false</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(element.<span class="property">detachEvent</span>)</span><br><span class="line">            element.<span class="title function_">detachEvent</span>(<span class="string">&#x27;on&#x27;</span>+type, handler);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            element[<span class="string">&#x27;on&#x27;</span>+type]=<span class="literal">null</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">stopPropagation</span>: <span class="keyword">function</span>(<span class="params">ev</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(ev.<span class="property">stopPropagation</span>)</span><br><span class="line">            ev.<span class="title function_">stopPropagation</span>();</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            ev.<span class="property">cancelBubble</span> = <span class="literal">true</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">preventDefault</span>: <span class="keyword">function</span>(<span class="params">ev</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(ev.<span class="property">preventDefault</span>)</span><br><span class="line">            ev.<span class="title function_">preventDefault</span>();</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            ev.<span class="property">returnValue</span> = <span class="literal">false</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//获取事件源对象,点谁谁就是事件源</span></span><br><span class="line">    <span class="attr">getTarget</span>: <span class="keyword">function</span>(<span class="params">ev</span>)&#123;</span><br><span class="line">        <span class="comment">//target为火狐写法，srcElement为IE写法</span></span><br><span class="line">        <span class="comment">//chrome都有</span></span><br><span class="line">        <span class="keyword">return</span> ev.<span class="property">target</span> || ev.<span class="property">srcElement</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="dom2json"><a href="#dom2json" class="headerlink" title="dom2json"></a>dom2json</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    &lt;div&gt;</span></span><br><span class="line"><span class="comment">        &lt;span&gt;</span></span><br><span class="line"><span class="comment">        ...</span></span><br><span class="line"><span class="comment">        &lt;/span&gt;</span></span><br><span class="line"><span class="comment">    &lt;/div&gt;</span></span><br><span class="line"><span class="comment">    to</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment">        tag: &#x27;DIV&#x27;,</span></span><br><span class="line"><span class="comment">        children: [</span></span><br><span class="line"><span class="comment">            tag: &#x27;SPAN&#x27;,</span></span><br><span class="line"><span class="comment">            children: []</span></span><br><span class="line"><span class="comment">        ]</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">dom2json</span>(<span class="params">dom</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> obj = &#123;&#125;;</span><br><span class="line">    obj.<span class="property">tag</span> = dom.<span class="property">tagName</span>;</span><br><span class="line">    obj.<span class="property">children</span> = [];</span><br><span class="line">    dom.<span class="property">childNodes</span>.<span class="title function_">forEach</span>(<span class="function"><span class="params">child</span>=&gt;</span>&#123;</span><br><span class="line">        obj.<span class="property">children</span>.<span class="title function_">push</span>(<span class="title function_">dom2json</span>(child));</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="json2dom"><a href="#json2dom" class="headerlink" title="json2dom"></a>json2dom</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">//     tag: &#x27;DIV&#x27;,</span></span><br><span class="line"><span class="comment">//     attrs:&#123;</span></span><br><span class="line"><span class="comment">//     		id:&#x27;app&#x27;</span></span><br><span class="line"><span class="comment">//     &#125;,</span></span><br><span class="line"><span class="comment">//     children: [</span></span><br><span class="line"><span class="comment">//       &#123;</span></span><br><span class="line"><span class="comment">//         tag: &#x27;SPAN&#x27;,</span></span><br><span class="line"><span class="comment">//         children: [</span></span><br><span class="line"><span class="comment">//           &#123; tag: &#x27;A&#x27;, children: [] &#125;</span></span><br><span class="line"><span class="comment">//         ]</span></span><br><span class="line"><span class="comment">//       &#125;,</span></span><br><span class="line"><span class="comment">//       &#123;</span></span><br><span class="line"><span class="comment">//         tag: &#x27;SPAN&#x27;,</span></span><br><span class="line"><span class="comment">//         children: [</span></span><br><span class="line"><span class="comment">//           &#123; tag: &#x27;A&#x27;, children: [] &#125;,</span></span><br><span class="line"><span class="comment">//           &#123; tag: &#x27;A&#x27;, children: [] &#125;</span></span><br><span class="line"><span class="comment">//         ]</span></span><br><span class="line"><span class="comment">//       &#125;</span></span><br><span class="line"><span class="comment">//     ]</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">//   把上诉虚拟Dom转化成下方真实Dom</span></span><br><span class="line"><span class="comment">//   &lt;div id=&quot;app&quot;&gt;</span></span><br><span class="line"><span class="comment">//     &lt;span&gt;</span></span><br><span class="line"><span class="comment">//       &lt;a&gt;&lt;/a&gt;</span></span><br><span class="line"><span class="comment">//     &lt;/span&gt;</span></span><br><span class="line"><span class="comment">//     &lt;span&gt;</span></span><br><span class="line"><span class="comment">//       &lt;a&gt;&lt;/a&gt;</span></span><br><span class="line"><span class="comment">//       &lt;a&gt;&lt;/a&gt;</span></span><br><span class="line"><span class="comment">//     &lt;/span&gt;</span></span><br><span class="line"><span class="comment">//   &lt;/div&gt;</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">json2dom</span>(<span class="params">vdom</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">typeof</span> vdom === <span class="string">&#x27;number&#x27;</span>)</span><br><span class="line">        vdom = <span class="title class_">String</span>(vdom);</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">typeof</span> vdom === <span class="string">&#x27;string&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">document</span>.<span class="title function_">createTextNode</span>(vdom);</span><br><span class="line">    <span class="keyword">const</span> dom = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(vdom.<span class="property">tag</span>);</span><br><span class="line">    <span class="keyword">if</span>(vdom.<span class="property">attrs</span>)&#123;</span><br><span class="line">        <span class="title class_">Object</span>.<span class="title function_">keys</span>(vdom.<span class="property">attrs</span>).<span class="title function_">forEach</span>(<span class="function"><span class="params">key</span>=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">const</span> value = vdom.<span class="property">attrs</span>[key];</span><br><span class="line">            dom.<span class="title function_">setAttribute</span>(key, value);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    vdom.<span class="property">children</span>.<span class="title function_">forEach</span>(<span class="function"><span class="params">child</span>=&gt;</span>&#123;</span><br><span class="line">        dom.<span class="title function_">appendChild</span>(<span class="title function_">json2dom</span>(child));</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> dom;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="async-x2F-await"><a href="#async-x2F-await" class="headerlink" title="async&#x2F;await"></a>async&#x2F;await</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">run</span>(<span class="params">gen</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> g = <span class="title function_">gen</span>();</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">next</span>(<span class="params">value</span>)&#123;</span><br><span class="line">            <span class="keyword">let</span> res;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                res = g.<span class="title function_">next</span>(value);</span><br><span class="line">            &#125;<span class="keyword">catch</span>(err)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="title function_">reject</span>(err);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(res.<span class="property">done</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="title function_">resolve</span>(res.<span class="property">value</span>);</span><br><span class="line">            <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(res.<span class="property">value</span>).<span class="title function_">then</span>(</span><br><span class="line">            	<span class="function"><span class="params">value</span> =&gt;</span> <span class="title function_">next</span>(value),</span><br><span class="line">                <span class="function"><span class="params">reason</span>=&gt;</span>g.<span class="keyword">throw</span>(reason)</span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="数组乱序"><a href="#数组乱序" class="headerlink" title="数组乱序"></a>数组乱序</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">shuffle</span>(<span class="params">arr</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> i = arr.<span class="property">length</span>;</span><br><span class="line">    <span class="keyword">while</span>(i)&#123;</span><br><span class="line">        <span class="keyword">let</span> j=<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>()*i--);</span><br><span class="line">        [arr[j], arr[i]]=[arr[i], arr[j]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="并行promise"><a href="#并行promise" class="headerlink" title="并行promise"></a>并行promise</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Schedule</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">limit</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">maxCount</span> = limit;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">queue</span> = [];</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">runCount</span> = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">add</span>(<span class="params">time, order</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> <span class="title function_">createPromise</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                    <span class="title function_">resolve</span>(order);</span><br><span class="line">                &#125;, time);</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">queue</span>.<span class="title function_">push</span>(createPromise);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">taskStart</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">this</span>.<span class="property">queue</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">request</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">request</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">runCount</span> &gt;= <span class="variable language_">this</span>.<span class="property">maxCount</span> || !<span class="variable language_">this</span>.<span class="property">queue</span> || !<span class="variable language_">this</span>.<span class="property">queue</span>.<span class="property">length</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">runCount</span>++;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">queue</span>.<span class="title function_">shift</span>()().<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">runCount</span>--;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">request</span>();</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="双向数据绑定"><a href="#双向数据绑定" class="headerlink" title="双向数据绑定"></a>双向数据绑定</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width&quot;&gt;</span><br><span class="line">    &lt;title&gt;&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        show: &lt;h1&gt;&lt;/h1&gt;</span><br><span class="line">        input: &lt;input type=&quot;text&quot;&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        function defined()&#123;</span><br><span class="line">            let obj = &#123;&#125;;</span><br><span class="line">            let val;</span><br><span class="line">            Object.defineProperties(obj, &#123;</span><br><span class="line">                val: &#123;</span><br><span class="line">                    get()&#123;</span><br><span class="line">                        return val;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    set(newVal)&#123;</span><br><span class="line">                        val = newVal;</span><br><span class="line">                        document.querySelector(&#x27;h1&#x27;).innerText = val;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            return obj;</span><br><span class="line">        &#125;</span><br><span class="line">        let newObj = defined();</span><br><span class="line">        document.querySelector(&#x27;input&#x27;).addEventListener(&#x27;input&#x27;, function()&#123;</span><br><span class="line">            newObj.val = document.querySelector(&#x27;input&#x27;).value;</span><br><span class="line">        &#125;)</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>



<h3 id="tips"><a href="#tips" class="headerlink" title="tips"></a>tips</h3><h4 id="数组-1"><a href="#数组-1" class="headerlink" title="数组"></a>数组</h4><ul>
<li>reduce \ forEach \ filter \ every \ some会跳过空位</li>
<li>map \ slice 不会跳过空位</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://cheyennee.github.io">Cheyennee</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://cheyennee.github.io/2021/09/13/%E6%89%8B%E5%86%99%E9%A2%98/">http://cheyennee.github.io/2021/09/13/%E6%89%8B%E5%86%99%E9%A2%98/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://cheyennee.github.io" target="_blank">Cheyennee</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://cheyennee-blog.oss-cn-hangzhou.aliyuncs.com/images/handwrite/pic4.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/09/15/linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"><img class="prev-cover" src="https://cheyennee-blog.oss-cn-hangzhou.aliyuncs.com/images/linux/cover.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">linux常用命令</div></div></a></div><div class="next-post pull-right"><a href="/2021/09/10/JWT/"><img class="next-cover" src="https://cheyennee-blog.oss-cn-hangzhou.aliyuncs.com/images/jwt/cover.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">JWT</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Cheyennee</div><div class="author-info__description">生而为人，还请努力</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">44</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">1</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">19</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/cheyennee"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">在路上</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#Promise"><span class="toc-number">1.</span> <span class="toc-text">Promise</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E7%BB%84"><span class="toc-number">2.</span> <span class="toc-text">数组</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E7%BB%84%E6%8E%92%E5%BA%8F"><span class="toc-number">2.1.</span> <span class="toc-text">数组排序</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E7%BB%84%E5%8E%BB%E9%87%8D"><span class="toc-number">2.2.</span> <span class="toc-text">数组去重</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E7%BB%84%E5%AE%9E%E7%8E%B0-reduce%E4%B8%8EindexOf%E7%9A%84%E5%8F%82%E6%95%B0%E4%B8%8E%E5%88%AB%E7%9A%84%E6%96%B9%E6%B3%95%E4%B8%8D%E4%B8%80%E6%A0%B7"><span class="toc-number">2.3.</span> <span class="toc-text">数组实现: reduce与indexOf的参数与别的方法不一样</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E7%BB%84%E6%89%81%E5%B9%B3%E5%8C%96"><span class="toc-number">2.4.</span> <span class="toc-text">数组扁平化</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E7%BB%84%E8%BD%AC%E6%A0%91"><span class="toc-number">2.5.</span> <span class="toc-text">数组转树</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B1%BB%E6%95%B0%E7%BB%84%E8%BD%AC%E5%8C%96%E4%B8%BA%E6%95%B0%E7%BB%84"><span class="toc-number">3.</span> <span class="toc-text">类数组转化为数组</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%B2%E6%8A%96%E8%8A%82%E6%B5%81%EF%BC%9A"><span class="toc-number"></span> <span class="toc-text">防抖节流：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%98%B2%E6%8A%96"><span class="toc-number">1.</span> <span class="toc-text">防抖</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8A%82%E6%B5%81"><span class="toc-number">2.</span> <span class="toc-text">节流</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#setTimeout%E6%A8%A1%E6%8B%9FsetInterval"><span class="toc-number">3.</span> <span class="toc-text">setTimeout模拟setInterval</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#setInterval%E6%A8%A1%E6%8B%9FsetTimeout"><span class="toc-number">4.</span> <span class="toc-text">setInterval模拟setTimeout</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Ajax"><span class="toc-number">5.</span> <span class="toc-text">Ajax</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#call"><span class="toc-number">6.</span> <span class="toc-text">call</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#apply"><span class="toc-number">7.</span> <span class="toc-text">apply</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#bind"><span class="toc-number">8.</span> <span class="toc-text">bind</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#new"><span class="toc-number">9.</span> <span class="toc-text">new</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#create"><span class="toc-number">10.</span> <span class="toc-text">create</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#instanceof"><span class="toc-number">11.</span> <span class="toc-text">instanceof</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Object-is"><span class="toc-number">12.</span> <span class="toc-text">Object.is</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#deepclone"><span class="toc-number">13.</span> <span class="toc-text">deepclone</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%A7%E6%89%BF"><span class="toc-number"></span> <span class="toc-text">继承</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8E%9F%E5%9E%8B%E9%93%BE%E7%BB%A7%E6%89%BF"><span class="toc-number">1.</span> <span class="toc-text">原型链继承</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BB%A7%E6%89%BF"><span class="toc-number">2.</span> <span class="toc-text">构造函数式继承</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%84%E5%90%88%E5%BC%8F%E7%BB%A7%E6%89%BF"><span class="toc-number">3.</span> <span class="toc-text">组合式继承</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8E%9F%E5%9E%8B%E5%BC%8F%E7%BB%A7%E6%89%BF-%E6%B5%85%E6%8B%B7%E8%B4%9D"><span class="toc-number">4.</span> <span class="toc-text">原型式继承,浅拷贝</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%84%E7%94%9F%E5%BC%8F%E7%BB%A7%E6%89%BF"><span class="toc-number">5.</span> <span class="toc-text">寄生式继承</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%84%E7%94%9F%E7%BB%84%E5%90%88%E5%BC%8F%E7%BB%A7%E6%89%BF"><span class="toc-number">6.</span> <span class="toc-text">寄生组合式继承</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%A7%E6%95%B0%E7%9B%B8%E5%8A%A0"><span class="toc-number">7.</span> <span class="toc-text">大数相加</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A1%A8%E5%8D%95%E6%A0%A1%E9%AA%8C"><span class="toc-number">8.</span> <span class="toc-text">表单校验</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85%E8%80%85%E6%A8%A1%E5%BC%8F"><span class="toc-number">9.</span> <span class="toc-text">发布订阅者模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%8F%E6%95%B0%E6%8D%AE%EF%BC%9A%E5%88%86%E7%89%87%E6%B8%B2%E6%9F%93%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%87%8F%E6%95%B0%E6%8D%AE-requestAnimationFrame%E7%89%88"><span class="toc-number">10.</span> <span class="toc-text">小数据：分片渲染大数据量数据 requestAnimationFrame版</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DocumentFragment%E7%89%88"><span class="toc-number">11.</span> <span class="toc-text">DocumentFragment版</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BF%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%A7%A3%E6%9E%90"><span class="toc-number">12.</span> <span class="toc-text">模板字符串解析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#LRUcache"><span class="toc-number">13.</span> <span class="toc-text">LRUcache</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#LazyMan"><span class="toc-number">14.</span> <span class="toc-text">LazyMan</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#compose"><span class="toc-number">15.</span> <span class="toc-text">compose</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#curry"><span class="toc-number">16.</span> <span class="toc-text">curry</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#add"><span class="toc-number">17.</span> <span class="toc-text">add</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E7%94%A8%E4%BA%8B%E4%BB%B6%E4%BE%A6%E5%90%AC%E5%99%A8%E5%87%BD%E6%95%B0"><span class="toc-number">18.</span> <span class="toc-text">通用事件侦听器函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#dom2json"><span class="toc-number">19.</span> <span class="toc-text">dom2json</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#json2dom"><span class="toc-number">20.</span> <span class="toc-text">json2dom</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#async-x2F-await"><span class="toc-number">21.</span> <span class="toc-text">async&#x2F;await</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E7%BB%84%E4%B9%B1%E5%BA%8F"><span class="toc-number">22.</span> <span class="toc-text">数组乱序</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B9%B6%E8%A1%8Cpromise"><span class="toc-number">23.</span> <span class="toc-text">并行promise</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%8C%E5%90%91%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A"><span class="toc-number">24.</span> <span class="toc-text">双向数据绑定</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tips"><span class="toc-number"></span> <span class="toc-text">tips</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E7%BB%84-1"><span class="toc-number">1.</span> <span class="toc-text">数组</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/05/01/playwright/" title="playwright"><img src="https://cheyennee-blog.oss-cn-hangzhou.aliyuncs.com/images/linux/cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="playwright"/></a><div class="content"><a class="title" href="/2023/05/01/playwright/" title="playwright">playwright</a><time datetime="2023-04-30T23:25:56.000Z" title="发表于 2023-05-01 07:25:56">2023-05-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/03/27/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A8/" title="前端安全"><img src="https://cheyennee-blog.oss-cn-hangzhou.aliyuncs.com/images/interview/cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="前端安全"/></a><div class="content"><a class="title" href="/2023/03/27/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A8/" title="前端安全">前端安全</a><time datetime="2023-03-27T05:15:38.000Z" title="发表于 2023-03-27 13:15:38">2023-03-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/03/12/leetcode-for-js/" title="leetcode for js"><img src="https://cheyennee-blog.oss-cn-hangzhou.aliyuncs.com/images/handwrite/pic4.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="leetcode for js"/></a><div class="content"><a class="title" href="/2023/03/12/leetcode-for-js/" title="leetcode for js">leetcode for js</a><time datetime="2023-03-12T03:49:47.000Z" title="发表于 2023-03-12 11:49:47">2023-03-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/02/18/chrome-debug/" title="chrome debug"><img src="https://cheyennee-blog.oss-cn-hangzhou.aliyuncs.com/images/flatlist/cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="chrome debug"/></a><div class="content"><a class="title" href="/2023/02/18/chrome-debug/" title="chrome debug">chrome debug</a><time datetime="2023-02-18T14:58:36.000Z" title="发表于 2023-02-18 22:58:36">2023-02-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/01/30/angular/" title="angular"><img src="https://cheyennee-blog.oss-cn-hangzhou.aliyuncs.com/images/flex/cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="angular"/></a><div class="content"><a class="title" href="/2023/01/30/angular/" title="angular">angular</a><time datetime="2023-01-30T01:14:25.000Z" title="发表于 2023-01-30 09:14:25">2023-01-30</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By Cheyennee</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>